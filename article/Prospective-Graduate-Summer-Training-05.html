<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="zhfly">





<title>05. Transformerè¯¦è§£å’Œä¸»è¦æ¨¡å‹æ¦‚è§ˆ | zhfly&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    
    <link rel="stylesheet" href="/../fonts/iconfont/iconfont.css">
    
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    
    <script src="/js/jquery-3.6.0.min.js"></script>
    



    
    
        
    



<!-- æœç´¢çš„éƒ¨åˆ† -->



    <script>
    // function searchToggle() {
    //     const width = $(document.body).width()
    //     if(width > 479) {
    //         return;
    //     }
    //     const search = $('.search');
    //     const searchForm = $('.form-search')

    //     if(!search.hasClass("mobile-search")) {
    //         search.addClass("mobile-search");
    //     } else {
    //         search.removeClass("mobile-search");
    //     } 
    // }

    function searchToggle() {
        const width = $(document.body).width()
        if(width > 479) {
            return;
        }
        const search = $('.search');
        const searchForm = $('.form-search');
        const menuToggle = $('.menu-toggle');
        const title = $('.navbar-header-title ');

        if(!search.hasClass("mobile-search")) {
            search.addClass("mobile-search");
            menuToggle.addClass("open-search")
            title.addClass("mobile-title-hidden")
        } else {
            search.removeClass("mobile-search");
            menuToggle.removeClass("open-search")
            // title.css({visibility: 'visible'})
            title.removeClass("mobile-title-hidden")
        } 
    }



    function search(searchInputEl, formEl, flag) {
        const path = "/" + "search.json"; // å¯ä»¥åœ¨public ä¸‹æŸ¥çœ‹è¿™ä¸ªsearch.json
        $(formEl).submit(function(e){
            e.preventDefault();
            let target = null
            if(searchInputEl == null) {
                const screenWidth = $(document.body).width();
                target = screenWidth > 479 ? $('#pc-search-input') : $('#mobile-search-input');
                console.log(target);
            } else {
                target = $(searchInputEl)
            }

            if(!flag && target.val() === '') {
                return ;
            }

            $("#u-search").fadeIn(500, function() {
                $("body > .wrapper").addClass("modal-active");

                $.ajax({
                    url: path,
                    dataType: "json",
                    beforeSend: function (xhr) {
                        $input = target.val();
                        $(".form-input").val($input);
                        const loadingBar = $('.search-loading-bar') 
                        loadingBar.css({
                            width:'100%',
                            display: 'block'
                        });
                    },
                    success: function( datas ) {
                        console.log(datas);
                        const $resultPanel = $(".modal-body")[0];
                        let str = `<ul class="modal-results">`;
                        var keywords = $(".form-input").val().trim().toLowerCase().split(/[\s\-]+/);
                        $resultPanel.innerHTML = "";
                        let hasResult = false
                        let text = `<div class="no-result">æ‰¾ä¸åˆ°ä¸å…³é”®è¯ç›¸å…³çš„å†…å®¹....</div>`;

                        if ($(".form-input").val().trim().length <= 0) {
                            // æ²¡æœ‰ç»“æœ
                            $resultPanel.innerHTML = text;
                            return;
                        }
                        datas.forEach(function (data, index) {
                            var isMatch = true;
                            if (!data.title || data.title.trim() === '') {
                                data.title = "Untitled";
                            }
                            var data_title = data.title.trim().toLowerCase();
                            var data_content = data.content && data.content.trim().replace(/<[^>]+>/g, "").toLowerCase() || '';
                            var data_url = data.url;
                            var index_title = -1;
                            var index_content = -1;
                            var first_occur = -1;
                            // only match artiles with not empty contents
                            if (data_content !== '') {
                                keywords.forEach(function (keyword, i) {
                                    index_title = data_title.indexOf(keyword);
                                    index_content = data_content.indexOf(keyword);

                                    if (index_title < 0 && index_content < 0) {
                                        isMatch = false;
                                    } else {
                                        hasResult = true
                                        if (index_content < 0) {
                                            index_content = 0;
                                        }
                                        if (i == 0) {
                                            first_occur = index_content;
                                        }
                                    }
                                });
                            } else {
                                isMatch = false;
                            }
                            // show search results
                            if (isMatch) {
                                str += `<li class='result-item'><a href='${data_url}' class='result-item-detail'> <span class="title">${data_title}</span>`;
                                var content = data.content.trim().replace(/<[^>]+>/g, "");
                                if (first_occur >= 0) {
                                    // cut out 200 characters
                                    var start = first_occur - 40;
                                    var end = first_occur + 160;

                                    if (start < 0) {
                                        start = 0;
                                    }

                                    if (start == 0) {
                                        end = 200;
                                    }

                                    if (end > content.length) {
                                        end = content.length;
                                    }

                                    var match_content = content.substring(start, end);

                                    // highlight all keywords
                                    keywords.forEach(function (keyword) {
                                        var regS = new RegExp(keyword, "gi");
                                        match_content = match_content.replace(regS, `<em class="search-keyword">${keyword}</em>`);
                                    });

                                    str += `<span class="content"> ${match_content} ...</span></a>`;
                                }
                                str += "</li>";
                            }
                        });
                        str += "</ul>";
                        if(hasResult) {
                            $resultPanel.innerHTML = str;
                        } else {
                            $resultPanel.innerHTML = text;
                        }

                    },
                    complete: function() {
                        setTimeout(() => {
                                const loadingBar = $('.search-loading-bar') 
                                loadingBar.css({
                                    width:'0%',
                                    display: 'none'
                                });
                        }, 300)
                    }
                });
            })

        });
    }

    $(document).ready(function() {
        $('.modal-close').click(function () { 
            $("#u-search").fadeOut();
            $("body > .wrapper").removeClass("modal-active")
        })

        $('.modal-overlay').click(function() {
            $("#u-search").fadeOut();
            $("body > .wrapper").removeClass("modal-active")
        })
        search(null, ".form-search", false)
        search("#u-search-modal-form .form-input", ".u-search-modal-form", true)
    })
</script>

<meta name="generator" content="Hexo 6.1.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "Â· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "Â· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <!-- <div class="navbar-header header-logo"><a href="/">zhfly&#39;s Blog</a></div> -->
            <div class="navbar-header header-logo"><a href="/"><i class="iconfont icon-zhuye" style="font-size: 1em;"></i>zhfly&#39;s Blog</a></div>
            <div class="menu navbar-right">
                <!-- è¿™é‡Œè¡¨ç¤ºçš„æ˜¯pcç«¯æœç´¢æ¡† -->
                
                
    <div class="search ">
        <div class="search-btn" onClick="searchToggle()">
            <img src="/image/search.png" class="search-btn-img" />
        </div>
        <form class="form-search">
            <input class="input" placeholder="search" autocomplete="off" id="pc-search-input"/>
        </form>
    </div>

                
                    <a class="menu-item" href="/cv">CV</a>
                
                    <a class="menu-item" href="/publications">Publications</a>
                
                    <a class="menu-item" href="/awards">Awards</a>
                
                    <a class="menu-item" href="/top">Posts</a>
                
                    <a class="menu-item" href="/categories">Categories</a>
                
                    <a class="menu-item" href="/tags">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">zhfly&#39;s Blog</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <!-- <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div> -->
                <div class="navbar-mobile-right">
                    
                    
    <div class="search ">
        <div class="search-btn" onClick="searchToggle()">
            <img src="/image/search.png" class="search-btn-img" />
        </div>
        <form class="form-search">
            <input class="input" placeholder="search" autocomplete="off" id="mobile-search-input"/>
        </form>
    </div>

                    <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
                </div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/cv">CV</a>
                
                    <a class="menu-item" href="/publications">Publications</a>
                
                    <a class="menu-item" href="/awards">Awards</a>
                
                    <a class="menu-item" href="/top">Posts</a>
                
                    <a class="menu-item" href="/categories">Categories</a>
                
                    <a class="menu-item" href="/tags">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6;    // ä¸º 6 æ—¶å±•å¼€æ‰€æœ‰
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function () {
            tocbot.refresh(obj_merge(tocbot_default_config, { hasInnerContainers: true }));
        }, 420); // è¿™ä¸ªå€¼æ˜¯ç”± tocbot æºç é‡Œå®šä¹‰çš„ scrollSmoothDuration å¾—æ¥çš„
    }

    document.ready(function () {
        tocbot.init(obj_merge(tocbot_default_config, { collapseDepth: 1 }));
    });

    function expandToc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, { collapseDepth: expanded ? 1 : DEPTH_MAX }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">05. Transformerè¯¦è§£å’Œä¸»è¦æ¨¡å‹æ¦‚è§ˆ</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">zhfly</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">June 25, 2022&nbsp;&nbsp;20:55:08</a>
                        </span>
                    
                    <br/>
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/%E7%A0%940%E6%9A%91%E6%9C%9F%E5%9F%B9%E8%AE%AD/">ç ”0æš‘æœŸåŸ¹è®­</a>
                            
                        </span>
                    
                    <br/>
                    
                        <span class="post-count">
                        Words:
                        <a href="">7.2k</a> 
                        </span>
                        
                    
                        <span class="post-count">
                        Time:
                        <a href="">27min</a> 
                        </span>
                    

                    <!-- æ€»é˜…è¯»æ•° -->
                    
                        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span class="site-pv">
        Pageview:
        <i class="busuanzi-value" id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></i>
    </span>

                    
                        
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="1-èƒŒæ™¯ä»‹ç»"><a class="markdownIt-Anchor" href="#1-èƒŒæ™¯ä»‹ç»"></a> 1. èƒŒæ™¯ä»‹ç»</h1>
<h2 id="11-1-vs-1"><a class="markdownIt-Anchor" href="#11-1-vs-1"></a> 1.1 1 vs 1</h2>
<p>æœ€åŸºæœ¬çš„å•å±‚ç½‘ç»œï¼šå•ä¸ªè¾“å…¥å•ä¸ªè¾“å‡º</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-1.jpg" class="">
<h2 id="12-n-vs-m-sequence-to-sequenceseq2seq"><a class="markdownIt-Anchor" href="#12-n-vs-m-sequence-to-sequenceseq2seq"></a> 1.2 N vs M: Sequence-to-sequence(Seq2seq)</h2>
<p>è¾“å…¥ä¸€ä¸ªåºåˆ—ï¼Œè¾“å‡ºä¸€ä¸ªåºåˆ—ï¼Œè¾“å‡ºåºåˆ—çš„é•¿åº¦ç”±æ¨¡å‹å†³å®š</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-2.jpg" class="">
<h2 id="13-n-vs-n-rnn"><a class="markdownIt-Anchor" href="#13-n-vs-n-rnn"></a> 1.3 N vs N: RNN</h2>
<p>åºåˆ—å½¢çš„æ•°æ®ä¸å¤ªå¥½ç”¨åŸå§‹ç¥ç»ç½‘ç»œå¤„ç†ã€‚ä¸ºäº†å»ºæ¨¡åºåˆ—é—®é¢˜ï¼ŒRNNå¼•å…¥äº†éšçŠ¶æ€hï¼ˆhidden stateï¼‰çš„æ¦‚å¿µï¼Œhå¯ä»¥å¯¹åºåˆ—å½¢çš„æ•°æ®æå–ç‰¹å¾ï¼Œæ¥ç€å†è½¬æ¢ä¸ºè¾“å‡ºã€‚h1çš„è®¡ç®—å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-3.jpg" class="">
<p>h2çš„è®¡ç®—å’Œh1ç±»ä¼¼ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨è®¡ç®—æ—¶ï¼Œæ¯ä¸€æ­¥ä½¿ç”¨çš„å‚æ•°Uã€Wã€béƒ½æ˜¯ä¸€æ ·çš„ï¼Œå³æ¯ä¸ªæ­¥éª¤çš„å‚æ•°éƒ½æ˜¯å…±äº«çš„ã€‚</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-4.jpg" class="">
<p>ä¾æ¬¡è®¡ç®—å‰©ä¸‹æ¥çš„ï¼ˆä½¿ç”¨ç›¸åŒçš„å‚æ•°Uã€Wã€bï¼‰:</p>
<p>â„3=ğ‘“(ğ‘ˆğ‘¥3+ğ‘Šâ„2+ğ‘)</p>
<p>â„4=ğ‘“(ğ‘ˆğ‘¥4+ğ‘Šâ„3+ğ‘)</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-5.jpg" class="">
<p>ç›´æ¥é€šè¿‡hè¿›è¡Œè®¡ç®—å¾—åˆ°RNNçš„è¾“å‡ºï¼š</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-6.jpg" class="">
<p>å‰©ä¸‹çš„è¾“å‡ºç±»ä¼¼è¿›è¡Œï¼ˆä½¿ç”¨å’Œy1åŒæ ·çš„å‚æ•°ï¼‰</p>
<p>ğ‘¦2=ğ‘†ğ‘œğ‘“ğ‘¡ğ‘šğ‘ğ‘¥(ğ‘‰â„2+ğ‘)</p>
<p>ğ‘¦3=ğ‘†ğ‘œğ‘“ğ‘¡ğ‘šğ‘ğ‘¥(ğ‘‰â„3+ğ‘)</p>
<p>ğ‘¦4=ğ‘†ğ‘œğ‘“ğ‘¡ğ‘šğ‘ğ‘¥(ğ‘‰â„4+ğ‘)</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-7.jpg" class="">
<ul>
<li>è®¡ç®—è§†é¢‘ä¸­æ¯ä¸€å¸§çš„åˆ†ç±»æ ‡ç­¾</li>
<li>è¾“å…¥ä¸ºå­—ç¬¦ï¼Œè¾“å‡ºä¸ºä¸‹ä¸€ä¸ªå­—ç¬¦çš„æ¦‚ç‡</li>
<li>â€¦â€¦</li>
</ul>
<h2 id="14-n-vs-1"><a class="markdownIt-Anchor" href="#14-n-vs-1"></a> 1.4 N vs 1</h2>
<p>è¾“å…¥æ˜¯ä¸€ä¸ªåºåˆ—ï¼Œè¾“å‡ºä¸€ä¸ªå€¼ï¼Œé€šå¸¸ç”¨æ¥å¤„ç†åºåˆ—åˆ†ç±»é—®é¢˜</p>
<p>ğ‘¦=ğ‘†ğ‘œğ‘“ğ‘¡ğ‘šğ‘ğ‘¥(ğ‘‰â„4+ğ‘)</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-8.jpg" class="">
<ul>
<li>è¾“å…¥ä¸€æ®µæ–‡å­—åˆ¤åˆ«å®ƒæ‰€å±çš„ç±»åˆ«</li>
<li>è¾“å…¥ä¸€ä¸ªå¥å­åˆ¤æ–­å…¶æƒ…æ„Ÿå€¾å‘</li>
<li>è¾“å…¥ä¸€æ®µè§†é¢‘å¹¶åˆ¤æ–­å®ƒçš„ç±»åˆ«</li>
<li>â€¦â€¦</li>
</ul>
<h2 id="15-1-vs-n"><a class="markdownIt-Anchor" href="#15-1-vs-n"></a> 1.5 1 vs N</h2>
<p>è¾“å…¥æ˜¯ä¸€ä¸ªå€¼ï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ªåºåˆ—</p>
<p>ğ‘¦1=ğ‘†ğ‘œğ‘“ğ‘¡ğ‘šğ‘ğ‘¥(ğ‘‰â„1+ğ‘)</p>
<p>ğ‘¦2=ğ‘†ğ‘œğ‘“ğ‘¡ğ‘šğ‘ğ‘¥(ğ‘‰â„2+ğ‘)</p>
<p>ğ‘¦3=ğ‘†ğ‘œğ‘“ğ‘¡ğ‘šğ‘ğ‘¥(ğ‘‰â„3+ğ‘)</p>
<p>ğ‘¦4=ğ‘†ğ‘œğ‘“ğ‘¡ğ‘šğ‘ğ‘¥(ğ‘‰â„4+ğ‘)</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-9.jpg" class="">
<img src="/article/Prospective-Graduate-Summer-Training-05/05-10.jpg" class="">
<img src="/article/Prospective-Graduate-Summer-Training-05/05-11.jpg" class="">
<ul>
<li>ä»å›¾åƒç”Ÿæˆæ–‡å­—</li>
<li>ä»ç±»åˆ«ç”Ÿæˆè¯­éŸ³æˆ–éŸ³ä¹ç­‰</li>
<li>â€¦â€¦</li>
</ul>
<h2 id="16-n-vs-m-sequence-to-sequenceseq2seq"><a class="markdownIt-Anchor" href="#16-n-vs-m-sequence-to-sequenceseq2seq"></a> 1.6 N vs M: Sequence-to-sequence(Seq2seq)</h2>
<p>è¾“å…¥ä¸€ä¸ªåºåˆ—ï¼Œè¾“å‡ºä¸€ä¸ªåºåˆ—ï¼Œè¿™ç§ç»“æ„åˆå«Encoder-Decoderæ¨¡å‹ï¼Œä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºSeq2Seqæ¨¡å‹<br>
Encoder-Decoderç»“æ„å…ˆå°†è¾“å…¥æ•°æ®ç¼–ç ï¼ˆEncoderï¼‰æˆä¸€ä¸ªä¸Šä¸‹æ–‡å‘é‡cï¼š</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-12.jpg" class="">
<p>(1)  ğ‘=â„4</p>
<p>(2)  ğ‘=ğ‘(â„4)</p>
<p>(3)  ğ‘=ğ‘(â„1,â„2,â„3,â„4)</p>
<p>ç”¨å¦ä¸€ä¸ªRNNç½‘ç»œå¯¹å…¶è¿›è¡Œè§£ç ï¼ˆDecoderï¼‰ï¼š</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-13.jpg" class="">
<img src="/article/Prospective-Graduate-Summer-Training-05/05-14.jpg" class="">
<p>Encoder-Decoderç»“æ„ä¸é™åˆ¶è¾“å…¥å’Œè¾“å‡ºçš„åºåˆ—é•¿åº¦ï¼Œå› æ­¤åº”ç”¨çš„èŒƒå›´éå¸¸å¹¿æ³›ï¼š</p>
<ul>
<li>æœºå™¨ç¿»è¯‘ï¼šEncoder-Decoderæœ€å…ˆå°±æ˜¯åœ¨æœºå™¨ç¿»è¯‘é¢†åŸŸæœ€å…ˆæå‡ºçš„</li>
<li>æ–‡æœ¬æ‘˜è¦ï¼šè¾“å…¥ä¸€æ®µæ–‡æœ¬åºåˆ—ï¼Œè¾“å‡ºè¿™æ®µæ–‡æœ¬åºåˆ—çš„æ‘˜è¦åºåˆ—</li>
<li>é˜…è¯»ç†è§£ï¼šå°†è¾“å…¥çš„æ–‡ç« å’Œé—®é¢˜åˆ†åˆ«ç¼–ç ï¼Œå†å¯¹å…¶è¿›è¡Œè§£ç å¾—åˆ°é—®é¢˜çš„ç­”æ¡ˆ</li>
<li>è¯­éŸ³è¯†åˆ«ï¼šè¾“å…¥æ˜¯è¯­éŸ³ä¿¡å·åºåˆ—ï¼Œè¾“å‡ºæ˜¯æ–‡å­—åºåˆ—</li>
<li>â€¦â€¦</li>
</ul>
<h2 id="17-seq2seq"><a class="markdownIt-Anchor" href="#17-seq2seq"></a> 1.7 Seq2seq</h2>
<p>åœ¨Seq2Seqç»“æ„ä¸­ï¼Œç¼–ç å™¨EncoderæŠŠæ‰€æœ‰çš„è¾“å…¥åºåˆ—éƒ½ç¼–ç æˆä¸€ä¸ªç»Ÿä¸€çš„è¯­ä¹‰å‘é‡Contextï¼Œç„¶åå†ç”±è§£ç å™¨Decoderè§£ç ã€‚åœ¨è§£ç å™¨Decoderè§£ç çš„è¿‡ç¨‹ä¸­ï¼Œä¸æ–­åœ°å°†å‰ä¸€ä¸ªæ—¶åˆ»t-1çš„è¾“å‡ºä½œä¸ºåä¸€ä¸ªæ—¶åˆ»tçš„è¾“å…¥ï¼Œå¾ªç¯è§£ç ï¼Œç›´åˆ°è¾“å‡ºåœæ­¢ç¬¦ä¸ºæ­¢ã€‚</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-15.jpg" class="">
<h3 id="seq2seqè®­ç»ƒé—®é¢˜"><a class="markdownIt-Anchor" href="#seq2seqè®­ç»ƒé—®é¢˜"></a> Seq2seqè®­ç»ƒé—®é¢˜</h3>
<p>åœ¨seq2seqç»“æ„ä¸­å°† ğ‘¦_ğ‘¡ä½œä¸ºä¸‹ä¸€æ—¶åˆ»è¾“å…¥ğ‘¥_(ğ‘¡+1) è¿›ç½‘ç»œï¼Œé‚£ä¹ˆæŸä¸€æ—¶åˆ»è¾“å‡º é”™è¯¯å°±ä¼šå¯¼è‡´åé¢å…¨é”™ã€‚åœ¨è®­ç»ƒæ—¶ç”±äºç½‘ç»œå°šæœªæ”¶æ•›ï¼Œè¿™ç§è´è¶æ•ˆåº”æ ¼å¤–æ˜æ˜¾<br>
Scheduled Samplingï¼šåœ¨è®­ç»ƒä¸­ğ‘¥_ğ‘¡æŒ‰ç…§ä¸€å®šæ¦‚ç‡é€‰æ‹©è¾“å…¥ ğ‘¦_(ğ‘¡âˆ’1)æˆ– t-1æ—¶åˆ»å¯¹åº”çš„çœŸå®å€¼ï¼Œå³æ ‡ç­¾ï¼Œæ—¢èƒ½åŠ å¿«è®­ç»ƒé€Ÿåº¦ï¼Œä¹Ÿèƒ½æé«˜è®­ç»ƒç²¾åº¦ã€‚</p>
<h3 id="åŸºäºattentionçš„seq2seq"><a class="markdownIt-Anchor" href="#åŸºäºattentionçš„seq2seq"></a> åŸºäºAttentionçš„Seq2seq</h3>
<p>é€šä¿—ç†è§£Attentionï¼šSEæ¨¡å—æœ€ç»ˆæ˜¯å­¦ä¹ å‡ºä¸€ä¸ª1x1xcçš„å‘é‡ï¼Œç„¶åé€é€šé“ä¹˜ä»¥åŸå§‹è¾“å…¥ï¼Œä»è€Œå¯¹ç‰¹å¾å›¾çš„æ¯ä¸ªé€šé“è¿›è¡ŒåŠ æƒå³é€šé“æ³¨æ„åŠ›</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-16.png" class="">
<p>Attentionæœºåˆ¶é€šè¿‡åœ¨æ¯ä¸ªæ—¶é—´è¾“å…¥ä¸åŒçš„cæ¥è§£å†³cé•¿åº¦å—é™é—®é¢˜ï¼Œå¸¦æœ‰Attentionæœºåˆ¶çš„Decoderå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-17.jpg" class="">
<ul>
<li>æ¯ä¸€ä¸ªcä¼šè‡ªåŠ¨å»é€‰å–ä¸å½“å‰æ‰€è¦è¾“å‡ºçš„yæœ€åˆé€‚çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</li>
<li>ç”¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>è¡¡é‡Encoderä¸­ç¬¬jé˜¶æ®µçš„hjå’Œè§£ç æ—¶ç¬¬ié˜¶æ®µçš„ç›¸å…³æ€§ï¼Œæœ€ç»ˆDecoderä¸­ç¬¬ié˜¶æ®µçš„è¾“å…¥çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ ciå°±æ¥è‡ªäºhjå¯¹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>çš„åŠ æƒå’Œ</li>
</ul>
<blockquote>
<p>å¦‚ä½•å¾—åˆ°æƒé‡ğ’‚_ğ’Šğ’‹ï¼Ÿ<br>
ä»æ¨¡å‹ä¸­å­¦ä¹ ï¼Œå’ŒDecoderçš„ç¬¬i-1é˜¶æ®µçš„éšçŠ¶æ€ã€Encoderç¬¬jä¸ªé˜¶æ®µçš„éšçŠ¶æ€æœ‰å…³</p>
</blockquote>
<p><strong>åŸºäºattentionçš„seq2seqçš„ç»“æ„çš„ç¼ºé™·ï¼š</strong></p>
<ul>
<li>ä¸ç®¡æ˜¯é‡‡ç”¨RNNã€LSTMè¿˜æ˜¯GRUéƒ½ä¸åˆ©äºå¹¶è¡Œè®­ç»ƒå’Œæ¨ç†ï¼Œå› ä¸ºç›¸å…³ç®—æ³•åªèƒ½ä»å·¦å‘å³ä¾æ¬¡è®¡ç®—æˆ–è€…ä»å³å‘å·¦ä¾æ¬¡è®¡ç®—ã€‚æ— æ³•å¹¶è¡Œè®­ç»ƒï¼Œä¸åˆ©äºå¤§è§„æ¨¡å¿«é€Ÿè®­ç»ƒå’Œéƒ¨ç½²ï¼Œä¹Ÿä¸åˆ©äºæ•´ä¸ªç®—æ³•é¢†åŸŸå‘å±•ã€‚</li>
<li>é•¿ä¾èµ–ä¿¡æ¯ä¸¢å¤±é—®é¢˜ï¼Œé¡ºåºè®¡ç®—è¿‡ç¨‹ä¸­ä¿¡æ¯ä¼šä¸¢å¤±ï¼Œè™½ç„¶LSTMå·ç§°æœ‰ç¼“è§£ï¼Œä½†æ˜¯æ— æ³•å½»åº•è§£å†³</li>
</ul>
<h1 id="2-transformer"><a class="markdownIt-Anchor" href="#2-transformer"></a> 2. Transformer</h1>
<h2 id="21-ç®€ä»‹"><a class="markdownIt-Anchor" href="#21-ç®€ä»‹"></a> 2.1 ç®€ä»‹</h2>
<p>Transformerç»“åˆself-attentionå’Œcross-attentionè¿›è¡Œäº†æ”¹è¿›ã€‚<br>
åœ¨encodeé˜¶æ®µï¼Œé‡ç‚¹å­¦ä¹ è¾“å…¥å…ƒç´ ä¹‹é—´çš„attentionã€‚åœ¨decodeé˜¶æ®µï¼Œé‡ç‚¹å­¦ä¹ çš„è¾“å‡ºæŸ¥è¯¢ä¸encodeçš„ç»“æœä¹‹é—´çš„attentionã€‚</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-18.jpg" class="">
<img src="/article/Prospective-Graduate-Summer-Training-05/05-19.jpg" class="">
<h3 id="æ·±å…¥åˆ†æ"><a class="markdownIt-Anchor" href="#æ·±å…¥åˆ†æ"></a> æ·±å…¥åˆ†æ</h3>
<ul>
<li>Qå’Œæ‰€æœ‰Kè®¡ç®—ç›¸ä¼¼æ€§</li>
<li>å¯¹ç›¸ä¼¼æ€§é‡‡ç”¨softmaxè½¬åŒ–ä¸ºæ¦‚ç‡åˆ†å¸ƒ</li>
<li>å°†æ¦‚ç‡åˆ†å¸ƒå’ŒVè¿›è¡Œä¸€ä¸€å¯¹åº”ç›¸ä¹˜ï¼Œæœ€åç›¸åŠ å¾—åˆ°æ–°çš„å’ŒQä¸€æ ·é•¿çš„å‘é‡è¾“å‡º</li>
</ul>
<h3 id="ç¼–ç å™¨è¾“å…¥æ•°æ®å¤„ç†"><a class="markdownIt-Anchor" href="#ç¼–ç å™¨è¾“å…¥æ•°æ®å¤„ç†"></a> ç¼–ç å™¨è¾“å…¥æ•°æ®å¤„ç†</h3>
<ul>
<li>æ–¹æ³•ä¸€ï¼šå¼€ä¸€ä¸ªå¾ˆé•¿çš„One-hot Encodingå‘é‡ï¼Œå¿½ç•¥äº†è¯æ±‡ä¸è¯æ±‡ä¹‹é—´çš„å…³ç³»</li>
<li>æ–¹æ³•äºŒï¼šWord embeddingï¼Œå«æœ‰è¯­ä¹‰ä¿¡æ¯</li>
</ul>
<blockquote>
<p>Embeddingï¼šä»»ä½•ä¸€ä¸ªå•è¯ï¼Œéƒ½å¯ä»¥è¢«æ˜ å°„æˆä¸ºå”¯ä¸€çš„ä¸€ä¸ªNç»´å‘é‡</p>
</blockquote>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-20.jpg" class="">
<h2 id="22-positional-encoding"><a class="markdownIt-Anchor" href="#22-positional-encoding"></a> 2.2 Positional encoding</h2>
<p>Transformerå†…éƒ¨æ²¡æœ‰ç±»ä¼¼RNNçš„å¾ªç¯ç»“æ„ï¼Œæ²¡æœ‰æ•æ‰é¡ºåºåºåˆ—çš„èƒ½åŠ›ï¼Œæˆ–è€…è¯´æ— è®ºå¥å­ç»“æ„æ€ä¹ˆæ‰“ä¹±ï¼Œtransformeréƒ½ä¼šå¾—åˆ°ç±»ä¼¼çš„ç»“æœã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ç¼–ç è¯å‘é‡æ—¶ä¼šé¢å¤–å¼•å…¥äº†ä½ç½®ç¼–ç position encodingå‘é‡è¡¨ç¤ºä¸¤ä¸ªå•è¯iå’Œjä¹‹é—´çš„è·ç¦»ï¼Œç®€å•æ¥è¯´å°±æ˜¯åœ¨è¯å‘é‡ä¸­åŠ å…¥äº†å•è¯çš„ä½ç½®ä¿¡æ¯</p>
<ul>
<li>ç½‘ç»œè‡ªåŠ¨å­¦ä¹ </li>
<li>è‡ªå·±å®šä¹‰è§„åˆ™</li>
</ul>
<h3 id="ç½‘ç»œè‡ªåŠ¨å­¦ä¹ "><a class="markdownIt-Anchor" href="#ç½‘ç»œè‡ªåŠ¨å­¦ä¹ "></a> ç½‘ç»œè‡ªåŠ¨å­¦ä¹ </h3>
<p>ç½‘ç»œè‡ªåŠ¨å­¦ä¹ </p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-21.png" class="">
<p>æ¯”è¾ƒç®€å•ï¼Œå› ä¸ºä½ç½®ç¼–ç å‘é‡éœ€è¦å’Œè¾“å…¥embedding(b,N,512)ç›¸åŠ ï¼Œæ‰€ä»¥å…¶shapeä¸º(1,N,512)è¡¨ç¤ºNä¸ªä½ç½®ï¼Œæ¯ä¸ªä½ç½®é‡‡ç”¨512é•¿åº¦å‘é‡è¿›è¡Œç¼–ç </p>
<h3 id="è‡ªå·±å®šä¹‰è§„åˆ™sin-cosè§„åˆ™"><a class="markdownIt-Anchor" href="#è‡ªå·±å®šä¹‰è§„åˆ™sin-cosè§„åˆ™"></a> è‡ªå·±å®šä¹‰è§„åˆ™ï¼šsin-cosè§„åˆ™</h3>
<ul>
<li>å°†å‘é‡çš„512ç»´åº¦åˆ‡åˆ†ä¸ºå¥‡æ•°è¡Œå’Œå¶æ•°è¡Œ</li>
<li>å¶æ•°è¡Œé‡‡ç”¨sinå‡½æ•°ç¼–ç ï¼Œå¥‡æ•°è¡Œé‡‡ç”¨coså‡½æ•°ç¼–ç </li>
<li>ç„¶åæŒ‰ç…§åŸå§‹è¡Œå·æ‹¼æ¥</li>
</ul>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-22.png" class="">
<h2 id="23-self-attention"><a class="markdownIt-Anchor" href="#23-self-attention"></a> 2.3 Self-Attention</h2>
<h3 id="ç¼–ç å™¨å‰å‘è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#ç¼–ç å™¨å‰å‘è¿‡ç¨‹"></a> ç¼–ç å™¨å‰å‘è¿‡ç¨‹</h3>
<p>å¯¹äºè‡ªæ³¨æ„åŠ›å±‚self-attentionæ¥è®²ï¼ŒQ(Query), K(Key), V(Value)ä¸‰ä¸ªçŸ©é˜µå‡æ¥è‡ªåŒä¸€è¾“å…¥</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-23.png" class="">
<p>1ï¼‰ ä»æ¯ä¸ªç¼–ç å™¨çš„è¾“å…¥å‘é‡åˆ›å»ºä¸‰ä¸ªå‘é‡ã€‚åˆ†åˆ«æ˜¯æŸ¥è¯¢å‘é‡Qã€é”®å‘é‡Kã€å€¼å‘é‡V<br>
2ï¼‰ é€šè¿‡æŸ¥è¯¢å‘é‡ä¸æ­£åœ¨è¯„åˆ†çš„å„ä¸ªå•è¯çš„å…³é”®å‘é‡çš„ç‚¹ç§¯æ¥è®¡ç®—åˆ†æ•°</p>
<h3 id="self-attentionçš„çŸ©é˜µè®¡ç®—"><a class="markdownIt-Anchor" href="#self-attentionçš„çŸ©é˜µè®¡ç®—"></a> Self-Attentionçš„çŸ©é˜µè®¡ç®—</h3>
<p>1ï¼‰ è®¡ç®—æŸ¥è¯¢ã€é”®å’Œå€¼çŸ©é˜µã€‚é€šè¿‡å°†Embeddingæ‰“åŒ…åˆ°çŸ©é˜µXä¸­ï¼Œå¹¶å°†å…¶ä¹˜ä»¥è®­ç»ƒçš„æƒé‡çŸ©é˜µï¼ˆWQã€WKã€WVï¼‰<br>
2ï¼‰è®¡ç®—è‡ªæ³¨æ„åŠ›å±‚çš„è¾“å‡º</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-24.png" class="">
<h3 id="self-attentionçš„ä»£ç å®ç°"><a class="markdownIt-Anchor" href="#self-attentionçš„ä»£ç å®ç°"></a> Self-Attentionçš„ä»£ç å®ç°</h3>
<p>å…ˆä»¤ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ‘¸</mi><mi mathvariant="normal">âˆ—</mi><msup><mi>ğ‘²</mi><mi>ğ‘»</mi></msup></mrow><annotation encoding="application/x-tex">ğ‘¸âˆ—ğ‘²^ğ‘»</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.037717em;vertical-align:-0.19444em;"></span><span class="mord boldsymbol" style="margin-right:0.09062em;">Q</span><span class="mord">âˆ—</span><span class="mord"><span class="mord boldsymbol" style="margin-right:0.14208em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8432769999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.12903em;">T</span></span></span></span></span></span></span></span></span></span></span>  ï¼Œå†å¯¹ç»“æœæŒ‰ä½ä¹˜ä»¥ MaskçŸ©é˜µï¼Œå†åš Softmaxæ“ä½œï¼Œæœ€åçš„ç»“æœä¸ Vç›¸ä¹˜ï¼Œå¾—åˆ°self-attentionçš„è¾“å‡º</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-25.png" class="">
<h3 id="self-attention-vs-cnn"><a class="markdownIt-Anchor" href="#self-attention-vs-cnn"></a> self-attention vs CNN</h3>
<ul>
<li>self-attentionåœ¨å¤„ç†ä¸€å¼ å›¾ç‰‡çš„æ—¶å€™ï¼Œ1çš„é‚£ä¸ªpixeläº§ç”Ÿqueryï¼Œå…¶ä»–çš„å„ä¸ªpixeläº§ç”Ÿkeyã€‚åœ¨åšinner-productçš„æ—¶å€™ï¼Œè€ƒè™‘çš„ä¸æ˜¯ä¸€ä¸ªå°çš„èŒƒå›´ï¼Œè€Œæ˜¯ä¸€æ•´å¼ å›¾ç‰‡ã€‚</li>
<li>CNNåªè€ƒè™‘æ„Ÿå—é‡çº¢æ¡†é‡Œé¢çš„èµ„è®¯ï¼Œè€Œä¸æ˜¯å›¾ç‰‡çš„å…¨å±€ä¿¡æ¯ã€‚æ‰€ä»¥CNNå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§ç®€åŒ–ç‰ˆæœ¬çš„self-attentionã€‚</li>
<li>self-attentionæ˜¯ä¸€ç§å¤æ‚åŒ–çš„CNNï¼Œåœ¨åšCNNçš„æ—¶å€™æ˜¯åªè€ƒè™‘æ„Ÿå—é‡çº¢æ¡†é‡Œé¢çš„ä¿¡æ¯ï¼Œè€Œæ„Ÿå—é‡çš„èŒƒå›´å’Œå¤§å°æ˜¯ç”±äººå†³å®šçš„ã€‚ä½†æ˜¯self-attentionç”±attentionæ‰¾åˆ°ç›¸å…³çš„pixelï¼Œå°±å¥½åƒæ˜¯æ„Ÿå—é‡çš„èŒƒå›´å’Œå¤§å°æ˜¯è‡ªåŠ¨è¢«å­¦å‡ºæ¥çš„ï¼Œæ‰€ä»¥CNNå¯ä»¥çœ‹åšæ˜¯self-attentionçš„ç‰¹ä¾‹ã€‚</li>
<li>self-attentionæ˜¯æ›´å¹¿ä¹‰çš„CNNï¼Œåˆ™è¿™ä¸ªæ¨¡å‹æ›´åŠ flexibleã€‚ä¸€ä¸ªæ¨¡å‹è¶Šflexibleï¼Œè®­ç»ƒå®ƒæ‰€éœ€è¦çš„æ•°æ®é‡å°±è¶Šå¤šï¼Œæ‰€ä»¥åœ¨è®­ç»ƒself-attentionæ¨¡å‹æ—¶å°±éœ€è¦æ›´å¤šçš„æ•°æ®ï¼Œè¿™ä¸€ç‚¹åœ¨ä¸‹é¢ä»‹ç»çš„è®ºæ–‡ ViT ä¸­æœ‰å°è¯ï¼Œå®ƒéœ€è¦çš„æ•°æ®é›†æ˜¯æœ‰3äº¿å¼ å›¾ç‰‡çš„JFT-300ï¼Œè€Œå¦‚æœä¸ä½¿ç”¨è¿™ä¹ˆå¤šæ•°æ®è€Œåªä½¿ç”¨ImageNetï¼Œåˆ™æ€§èƒ½ä¸å¦‚CNNã€‚</li>
</ul>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-26.png" class="">
<h2 id="24-multi-head-self-attention"><a class="markdownIt-Anchor" href="#24-multi-head-self-attention"></a> 2.4 Multi-head Self-Attention</h2>
<ul>
<li>å®ƒæ‰©å±•äº†æ¨¡å‹å…³æ³¨ä¸åŒä½ç½®çš„èƒ½åŠ›</li>
<li>ä¸ºæ³¨æ„åŠ›å±‚æä¾›äº†å¤šä¸ªâ€œè¡¨ç¤ºå­ç©ºé—´â€</li>
</ul>
<h3 id="multi-head-self-attentionçš„ä»£ç å®ç°"><a class="markdownIt-Anchor" href="#multi-head-self-attentionçš„ä»£ç å®ç°"></a> Multi-head Self-Attentionçš„ä»£ç å®ç°</h3>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-28.png" class="">
<img src="/article/Prospective-Graduate-Summer-Training-05/05-29.png" class="">
<h3 id="å‰é¦ˆç¥ç»ç½‘ç»œå±‚çš„ä»£ç å®ç°"><a class="markdownIt-Anchor" href="#å‰é¦ˆç¥ç»ç½‘ç»œå±‚çš„ä»£ç å®ç°"></a> å‰é¦ˆç¥ç»ç½‘ç»œå±‚çš„ä»£ç å®ç°</h3>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-30.png" class="">
<h3 id="å•ä¸ªç¼–ç å±‚çš„ä»£ç å®ç°"><a class="markdownIt-Anchor" href="#å•ä¸ªç¼–ç å±‚çš„ä»£ç å®ç°"></a> å•ä¸ªç¼–ç å±‚çš„ä»£ç å®ç°</h3>
<p>é™¤äº†ç¬¬ä¸€ä¸ªæ¨¡å—è¾“å…¥æ˜¯å•è¯åµŒå…¥å‘é‡ä¸ä½ç½®ç¼–ç çš„å’Œå¤–ï¼Œå…¶ä½™ç¼–ç å±‚è¾“å…¥æ˜¯ä¸Šä¸€ä¸ªç¼–ç å™¨è¾“å‡ºå³åé¢çš„ç¼–ç å™¨è¾“å…¥ä¸éœ€è¦ä½ç½®ç¼–ç å‘é‡</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-31.png" class="">
<img src="/article/Prospective-Graduate-Summer-Training-05/05-32.png" class="">
<h2 id="25-masked-multi-head-self-attention"><a class="markdownIt-Anchor" href="#25-masked-multi-head-self-attention"></a> 2.5 Masked Multi-Head Self-attention</h2>
<h3 id="ä¸ºä»€ä¹ˆéœ€è¦mask"><a class="markdownIt-Anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦mask"></a> ä¸ºä»€ä¹ˆéœ€è¦mask?</h3>
<p>è®­ç»ƒæ—¶ï¼šä¸é‡‡ç”¨ä¸Šè¿°ç±»ä¼¼RNNçš„æ–¹æ³•ä¸€ä¸ªä¸€ä¸ªç›®æ ‡å•è¯åµŒå…¥å‘é‡é¡ºåºè¾“å…¥è®­ç»ƒï¼Œæƒ³é‡‡ç”¨ç±»ä¼¼ç¼–ç å™¨ä¸­çš„çŸ©é˜µå¹¶è¡Œç®—æ³•ï¼Œä¸€æ­¥å°±æŠŠæ‰€æœ‰ç›®æ ‡å•è¯é¢„æµ‹å‡ºæ¥ã€‚è¦å®ç°è¿™ä¸ªåŠŸèƒ½å°±å¯ä»¥å‚è€ƒç¼–ç å™¨çš„æ“ä½œï¼ŒæŠŠç›®æ ‡å•è¯åµŒå…¥å‘é‡ç»„æˆçŸ©é˜µä¸€æ¬¡è¾“å…¥å³å¯ã€‚å³ï¼šå¹¶è¡ŒåŒ–è®­ç»ƒã€‚</p>
<p>ä½†æ˜¯åœ¨è§£ç haveæ—¶å€™ï¼Œä¸èƒ½åˆ©ç”¨åˆ°åé¢å•è¯aå’Œcatçš„ç›®æ ‡å•è¯åµŒå…¥å‘é‡ä¿¡æ¯ï¼Œå¦åˆ™è¿™å°±æ˜¯ä½œå¼Š(æµ‹è¯•æ—¶å€™ä¸å¯èƒ½èƒ½æœªåœå…ˆçŸ¥)ã€‚ä¸ºæ­¤å¼•å…¥maskã€‚å…·ä½“æ˜¯ï¼šåœ¨è§£ç å™¨ä¸­ï¼Œself-attentionå±‚åªè¢«å…è®¸å¤„ç†è¾“å‡ºåºåˆ—ä¸­æ›´é å‰çš„é‚£äº›ä½ç½®ï¼Œåœ¨softmaxæ­¥éª¤å‰ï¼Œå®ƒä¼šæŠŠåé¢çš„ä½ç½®ç»™éšå»ï¼ˆæŠŠå®ƒä»¬è®¾ä¸º-infï¼‰ ã€‚ä¸ºæ­¤å¼•å…¥maskï¼Œç›®çš„æ˜¯æ„æˆä¸‹ä¸‰è§’çŸ©é˜µï¼Œå³ä¸Šè§’å…¨éƒ¨è®¾ç½®ä¸ºè´Ÿæ— ç©·(ç›¸å½“äºå¿½ç•¥)ï¼Œä»è€Œå®ç°å½“è§£ç ç¬¬ä¸€ä¸ªå­—çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªå­—åªèƒ½ä¸ç¬¬ä¸€ä¸ªå­—è®¡ç®—ç›¸å…³æ€§ï¼Œå½“è§£å‡ºç¬¬äºŒä¸ªå­—çš„æ—¶å€™ï¼Œåªèƒ½è®¡ç®—å‡ºç¬¬äºŒä¸ªå­—ä¸ç¬¬ä¸€ä¸ªå­—å’Œç¬¬äºŒä¸ªå­—çš„ç›¸å…³æ€§ã€‚</p>
<p>è§£ç å™¨å†…éƒ¨çš„å¸¦æœ‰maskçš„MultiHeadAttentionçš„qkvå‘é‡è¾“å…¥æ¥è‡ªç›®æ ‡å•è¯åµŒå…¥æˆ–è€…å‰ä¸€ä¸ªè§£ç å™¨è¾“å‡ºï¼Œä¸‰è€…æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯åé¢çš„MultiHeadAttentionçš„qkvå‘é‡ä¸­çš„kvæ¥è‡ªæœ€åä¸€å±‚ç¼–ç å™¨çš„è¾“å…¥ï¼Œè€Œqæ¥è‡ªå¸¦æœ‰maskçš„MultiHeadAttentionæ¨¡å—çš„è¾“å‡º</p>
<h3 id="masked-multi-head-self-attentionçš„å…·ä½“æ“ä½œ"><a class="markdownIt-Anchor" href="#masked-multi-head-self-attentionçš„å…·ä½“æ“ä½œ"></a> Masked Multi-Head Self-attentionçš„å…·ä½“æ“ä½œï¼š</h3>
<ul>
<li>Step1ï¼šè¾“å…¥çŸ©é˜µåŒ…å« â€œ&lt;Begin&gt; I have a catâ€ (0, 1, 2, 3, 4) äº”ä¸ªå•è¯çš„è¡¨ç¤ºå‘é‡ï¼ŒMaskæ˜¯ä¸€ä¸ª 5Ã—5 çš„çŸ©é˜µã€‚åœ¨Maskå¯ä»¥å‘ç°å•è¯ 0 åªèƒ½ä½¿ç”¨å•è¯ 0 çš„ä¿¡æ¯ï¼Œè€Œå•è¯ 1 å¯ä»¥ä½¿ç”¨å•è¯ 0, 1 çš„ä¿¡æ¯ï¼Œå³åªèƒ½ä½¿ç”¨ä¹‹å‰çš„ä¿¡æ¯ã€‚</li>
<li>Step2ï¼š ğ‘¸^ğ‘»âˆ—ğ‘²å¾—åˆ° AttentionçŸ©é˜µï¼Œæ­¤æ—¶å…ˆä¸æ€¥äºåšsoftmaxçš„æ“ä½œï¼Œè€Œæ˜¯å…ˆäºä¸€ä¸ªMaskçŸ©é˜µç›¸ä¹˜ï¼Œä½¿å¾—attentionçŸ©é˜µçš„æœ‰äº›ä½ç½®å½’0ï¼Œå¾—åˆ°Masked AttentionçŸ©é˜µã€‚ MaskçŸ©é˜µæ˜¯ä¸ªä¸‹ä¸‰è§’çŸ©é˜µï¼Œä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿæ˜¯å› ä¸ºæƒ³åœ¨è®¡ç®—ZçŸ©é˜µçš„æŸä¸€è¡Œæ—¶ï¼Œåªè€ƒè™‘å®ƒå‰é¢tokençš„ä½œç”¨ã€‚å³ï¼šåœ¨è®¡ç®—Zçš„ç¬¬ä¸€è¡Œæ—¶ï¼Œåˆ»æ„åœ°æŠŠAttentionçŸ©é˜µç¬¬ä¸€è¡Œçš„åé¢å‡ ä¸ªå…ƒç´ å±è”½æ‰ã€‚åœ¨äº§ç”Ÿhaveè¿™ä¸ªå•è¯æ—¶ï¼Œåªè€ƒè™‘ Iï¼Œä¸è€ƒè™‘ä¹‹åçš„have a catï¼Œå³åªä¼šattend onå·²ç»äº§ç”Ÿçš„sequenceï¼Œè¿™ä¸ªå¾ˆåˆç†ï¼Œå› ä¸ºè¿˜æ²¡æœ‰äº§ç”Ÿå‡ºæ¥çš„ä¸œè¥¿ä¸å­˜åœ¨ï¼Œå°±æ— æ³•åšattentionã€‚</li>
<li>Step3ï¼šMasked AttentionçŸ©é˜µè¿›è¡Œ Softmaxï¼Œæ¯ä¸€è¡Œçš„å’Œéƒ½ä¸º 1ã€‚ä½†æ˜¯å•è¯ 0 åœ¨å•è¯ 1, 2, 3, 4 ä¸Šçš„ attention score éƒ½ä¸º 0ã€‚å¾—åˆ°çš„ç»“æœå†ä¸VçŸ©é˜µç›¸ä¹˜å¾—åˆ°æœ€ç»ˆçš„self-attentionå±‚çš„è¾“å‡ºç»“æœZ1ã€‚</li>
<li>Step4ï¼š Z1åªæ˜¯æŸä¸€ä¸ªheadçš„ç»“æœï¼Œå°†å¤šä¸ªheadçš„ç»“æœconcatåœ¨ä¸€èµ·ä¹‹åå†æœ€åè¿›è¡ŒLinear Transformationå¾—åˆ°æœ€ç»ˆçš„Masked Multi-Head Self-attentionçš„è¾“å‡ºç»“æœZã€‚</li>
</ul>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-33.jpg" class="">
<h3 id="maskçš„ä»£ç å®ç°"><a class="markdownIt-Anchor" href="#maskçš„ä»£ç å®ç°"></a> Maskçš„ä»£ç å®ç°</h3>
<p>src_mask = get_pad_mask(src_seq, self.src_pad_idx)<br>
ç”¨äºäº§ç”ŸEncoderçš„Maskï¼Œå®ƒæ˜¯ä¸€åˆ—Boolå€¼ï¼Œè´Ÿè´£æŠŠæ ‡ç‚¹maskæ‰ã€‚<br>
trg_mask = get_pad_mask(trg_seq, self.trg_pad_idx) &amp; get_subsequent_mask(trg_seq)<br>
ç”¨äºäº§ç”ŸDecoderçš„MaskçŸ©é˜µã€‚</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-34.png" class="">
<h3 id="å•ä¸ªè§£ç å±‚çš„ä»£ç å®ç°"><a class="markdownIt-Anchor" href="#å•ä¸ªè§£ç å±‚çš„ä»£ç å®ç°"></a> å•ä¸ªè§£ç å±‚çš„ä»£ç å®ç°</h3>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-35.png" class="">
<h3 id="å¤šä¸ªè§£ç å±‚çš„ä»£ç å®ç°"><a class="markdownIt-Anchor" href="#å¤šä¸ªè§£ç å±‚çš„ä»£ç å®ç°"></a> å¤šä¸ªè§£ç å±‚çš„ä»£ç å®ç°</h3>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-36.png" class="">
<h2 id="26-ä¼ ç»Ÿattention-self-attention-cross-attention"><a class="markdownIt-Anchor" href="#26-ä¼ ç»Ÿattention-self-attention-cross-attention"></a> 2.6 ä¼ ç»ŸAttentionã€Self Attentionã€Cross Attention</h2>
<ul>
<li>ä¼ ç»Ÿçš„Attentionæ˜¯åŸºäºsourceç«¯å’Œtargetç«¯çš„éšå˜é‡è®¡ç®—Attentionçš„ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯sourceç«¯çš„æ¯ä¸ªè¯ä¸targetç«¯æ¯ä¸ªè¯ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li>
<li>ä¼ ç»Ÿçš„Attentionæ˜¯åŸºäºsourceç«¯å’Œtargetç«¯çš„éšå˜é‡è®¡ç®—Attentionçš„ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯sourceç«¯çš„æ¯ä¸ªè¯ä¸targetç«¯æ¯ä¸ªè¯ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li>
<li>Self -Attentionåˆ†åˆ«åœ¨sourceç«¯å’Œtargetç«¯è¿›è¡Œè‡ªèº«çš„attentionï¼Œä»…ä¸source inputæˆ–è€…target inputè‡ªèº«ç›¸å…³çš„Self -Attentionï¼Œä»¥æ•æ‰sourceç«¯æˆ–targetç«¯è‡ªèº«çš„è¯ä¸è¯ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li>
<li>Cross-AttentionæŠŠsourceç«¯çš„å¾—åˆ°çš„self -AttentionåŠ å…¥åˆ°targetç«¯å¾—åˆ°çš„Attentionä¸­ï¼Œä»¥æ•æ‰sourceç«¯å’Œtargetç«¯è¯ä¸è¯ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li>
<li>ä¼ ç»Ÿçš„Attentionæœºåˆ¶å¿½ç•¥äº†æºç«¯æˆ–ç›®æ ‡ç«¯å¥å­ä¸­è¯ä¸è¯ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œself Attentionå¯ä»¥ä¸ä»…å¯ä»¥å¾—åˆ°æºç«¯ä¸ç›®æ ‡ç«¯è¯ä¸è¯ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ŒåŒæ—¶è¿˜å¯ä»¥æœ‰æ•ˆè·å–æºç«¯æˆ–ç›®æ ‡ç«¯è‡ªèº«è¯ä¸è¯ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li>
</ul>
<h1 id="3-è§†è§‰é¢†åŸŸçš„transformer"><a class="markdownIt-Anchor" href="#3-è§†è§‰é¢†åŸŸçš„transformer"></a> 3. è§†è§‰é¢†åŸŸçš„Transformer</h1>
<h2 id="31-transformerclassificationvision-transformer"><a class="markdownIt-Anchor" href="#31-transformerclassificationvision-transformer"></a> 3.1 Transformer+Classificationï¼šVision Transformer</h2>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-37.png" class="">
<h3 id="å›¾ç‰‡åˆ†å—å’Œé™ç»´"><a class="markdownIt-Anchor" href="#å›¾ç‰‡åˆ†å—å’Œé™ç»´"></a> å›¾ç‰‡åˆ†å—å’Œé™ç»´</h3>
<p>transformerçš„è¾“å…¥éœ€è¦åºåˆ—ï¼Œæœ€ç®€å•åšæ³•å°±æ˜¯æŠŠå›¾ç‰‡åˆ‡åˆ†ä¸ºpatchï¼Œç„¶åæ‹‰æˆåºåˆ—å³å¯ã€‚ å‡è®¾è¾“å…¥å›¾ç‰‡å¤§å°æ˜¯256x256ï¼Œæ‰“ç®—åˆ†æˆ64ä¸ªpatchï¼Œæ¯ä¸ªpatchæ˜¯32x32åƒç´ :</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-38.png" class="">
<p>Pä»£è¡¨patchå¤§å°ï¼Œå‡è®¾è¾“å…¥æ˜¯b,3,256,256ï¼Œåˆ™rearrangeæ“ä½œæ˜¯å…ˆå˜æˆ(b,3,8x32,8x32)ï¼Œæœ€åå˜æˆ(b,8x8,32x32x3)å³(b,64,3072)ï¼Œå°†æ¯å¼ å›¾ç‰‡åˆ‡åˆ†æˆ64ä¸ªå°å—ï¼Œæ¯ä¸ªå°å—é•¿åº¦æ˜¯32x32x3=3072ï¼Œä¹Ÿå°±æ˜¯è¯´è¾“å…¥é•¿åº¦ä¸º64çš„å›¾åƒåºåˆ—ï¼Œæ¯ä¸ªå…ƒç´ é‡‡ç”¨3072é•¿åº¦è¿›è¡Œç¼–ç ã€‚<br>
è€ƒè™‘åˆ°3072ç»´åº¦åå¤§ï¼Œæ•…å…ˆå¯¹å…¶è¿›è¡Œé™ç»´ï¼š</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-39.png" class="">
<blockquote>
<p>æ²¡æœ‰è§£ç å™¨å¦‚ä½•æ‰§è¡Œåˆ†ç±»é¢„æµ‹ï¼Ÿ<br>
ä½¿ç”¨CLS Tokenæ•´åˆè¾“å‡ºä¿¡æ¯<br>
Classçš„ä½œç”¨æœ‰ç‚¹ç±»ä¼¼äºè§£ç å™¨ä¸­çš„Queryçš„ä½œç”¨ï¼Œç›¸å¯¹åº”çš„Key,Valueå°±æ˜¯å…¶ä»–9ä¸ªç¼–ç å‘é‡çš„è¾“å‡º<br>
åœ¨æ•´åˆå›¾ç‰‡ä¿¡æ¯æ—¶ï¼Œä¸€ç§æ˜¯ä½¿ç”¨CLS Tokenï¼Œå¦ä¸€ç§æ˜¯å¯¹æ‰€æœ‰Tokensçš„è¾“å‡ºå–å¹³å‡ï¼Œä¸¤è€…å¯ä»¥è¾¾åˆ°åŒæ ·æ•ˆæœï¼š</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-40.png" class="">
</blockquote>
<h3 id="ä½ç½®ç¼–ç "><a class="markdownIt-Anchor" href="#ä½ç½®ç¼–ç "></a> ä½ç½®ç¼–ç </h3>
<p>ä½ç½®ç¼–ç é•¿åº¦ä¸º1024ï¼Œæœ¬æ–‡æ²¡æœ‰é‡‡ç”¨sincosç¼–ç ï¼Œè€Œæ˜¯ç›´æ¥è®¾ç½®ä¸ºå¯å­¦ä¹ ã€‚</p>
<p>ä½ç½®è¶Šæ¥è¿‘ï¼Œå¾€å¾€å…·æœ‰æ›´ç›¸ä¼¼çš„ä½ç½®ç¼–ç ã€‚æ­¤å¤–ï¼Œå‡ºç°äº†è¡Œåˆ—ç»“æ„ï¼›åŒä¸€è¡Œ/åˆ—ä¸­çš„patchå…·æœ‰ç›¸ä¼¼çš„ä½ç½®ç¼–ç ã€‚</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-43.png" class="">
<h3 id="ç¼–ç å™¨å‰å‘è¿‡ç¨‹-2"><a class="markdownIt-Anchor" href="#ç¼–ç å™¨å‰å‘è¿‡ç¨‹-2"></a> ç¼–ç å™¨å‰å‘è¿‡ç¨‹</h3>
<p>æ²¡æœ‰ä»»ä½•æ”¹åŠ¨çš„transformerï¼Œå‡è®¾è¾“å…¥æ˜¯(b,65,1024)ï¼Œé‚£ä¹ˆtransformerè¾“å‡ºä¹Ÿæ˜¯(b,65,1024)</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-41.png" class="">
<h3 id="åˆ†ç±»head"><a class="markdownIt-Anchor" href="#åˆ†ç±»head"></a> åˆ†ç±»head</h3>
<p>ç¼–ç å™¨åæ¥fcåˆ†ç±»å™¨head</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-42.png" class="">
<img src="/article/Prospective-Graduate-Summer-Training-05/05-44.jpg" class="">
<h3 id="vitæ•´ä½“æµç¨‹"><a class="markdownIt-Anchor" href="#vitæ•´ä½“æµç¨‹"></a> VITæ•´ä½“æµç¨‹ï¼š</h3>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-45.png" class="">
<img src="/article/Prospective-Graduate-Summer-Training-05/05-46.png" class="">
<h2 id="32-transformerdetectiondetr"><a class="markdownIt-Anchor" href="#32-transformerdetectiondetr"></a> 3.2 Transformer+Detectionï¼šDETR</h2>
<ul>
<li>ç”¨transformerçš„encoder-decoderæ¶æ„ä¸€æ¬¡æ€§ç”Ÿæˆ Nä¸ªbox predictionã€‚å…¶ä¸­Næ˜¯ä¸€ä¸ªäº‹å…ˆè®¾å®šçš„ã€æ¯”è¿œè¿œå¤§äºimageä¸­objectä¸ªæ•°çš„ä¸€ä¸ªæ•´æ•°ã€‚å°†ç›®æ ‡æ£€æµ‹é—®é¢˜è½¬åŒ–ä¸ºæ— åºé›†åˆé¢„æµ‹é—®é¢˜ã€‚</li>
<li>è®¾è®¡äº†bipartite matching lossï¼ŒåŸºäºé¢„æµ‹çš„boxeså’Œground truth boxesçš„äºŒåˆ†å›¾åŒ¹é…è®¡ç®—lossçš„å¤§å°ï¼Œä»è€Œä½¿å¾—é¢„æµ‹çš„boxçš„ä½ç½®å’Œç±»åˆ«æ›´æ¥è¿‘äºground truthã€‚
<ul>
<li>ä¸éœ€è¦è®¾ç½®å…ˆéªŒanchorå’Œproposalï¼›è¶…å‚å¾ˆå°‘ï¼›ä¸éœ€è¦nmsï¼ˆend to endï¼‰</li>
</ul>
</li>
</ul>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-47.png" class="">
<h3 id="cnnä¸»å¹²ç½‘ç»œç‰¹å¾æå–"><a class="markdownIt-Anchor" href="#cnnä¸»å¹²ç½‘ç»œç‰¹å¾æå–"></a> cnnä¸»å¹²ç½‘ç»œç‰¹å¾æå–</h3>
<p>ä¸»å¹²ç½‘ç»œå¯ä»¥æ˜¯ä»»ä½•ä¸€ç§ï¼Œä½œè€…é€‰æ‹©resnet50ï¼Œå°†æœ€åä¸€ä¸ªstageå³stride=32çš„ç‰¹å¾å›¾ä½œä¸ºç¼–ç å™¨è¾“å…¥ã€‚ç”±äºresnetä»…ä»…ä½œä¸ºä¸€ä¸ªå°éƒ¨åˆ†ä¸”å·²ç»ç»è¿‡äº†imageneté¢„è®­ç»ƒï¼Œæ•…å’Œå¸¸è§„æ“ä½œä¸€æ ·ï¼Œä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š</p>
<ul>
<li>resnetä¸­æ‰€æœ‰BNéƒ½å›ºå®šï¼Œå³é‡‡ç”¨å…¨å±€å‡å€¼å’Œæ–¹å·®</li>
<li>resnetçš„stemå’Œç¬¬ä¸€ä¸ªstageä¸è¿›è¡Œå‚æ•°æ›´æ–°ï¼Œå³parameter.requires_grad_(False)</li>
<li>backboneçš„å­¦ä¹ ç‡å°äºtransformer,lr_backbone=1e-05,å…¶ä½™ä¸º0.0001</li>
</ul>
<p>å‡è®¾è¾“å…¥æ˜¯(b,c,h,w)ï¼Œåˆ™resnet50è¾“å‡ºæ˜¯(b,2048,h//32,w//32)ï¼Œ2048æ¯”è¾ƒå¤§ï¼Œä¸ºäº†èŠ‚çœè®¡ç®—é‡ï¼Œå…ˆé‡‡ç”¨1x1å·ç§¯é™ç»´ä¸º256,æœ€åè½¬åŒ–ä¸ºåºåˆ—æ ¼å¼è¾“å…¥åˆ°transformerä¸­ï¼Œè¾“å…¥shape=(hâ€™xwâ€™,b,256)ï¼Œhâ€™=h//32</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-48.png" class="">
<h3 id="ç¼–ç å™¨è®¾è®¡å’Œè¾“å…¥"><a class="markdownIt-Anchor" href="#ç¼–ç å™¨è®¾è®¡å’Œè¾“å…¥"></a> ç¼–ç å™¨è®¾è®¡å’Œè¾“å…¥</h3>
<p><strong>ä½ç½®ç¼–ç éœ€è¦è€ƒè™‘2dç©ºé—´</strong></p>
<p>DETRè€ƒè™‘äº†xyæ–¹å‘çš„ä½ç½®ç¼–ç ï¼Œå› ä¸ºå›¾åƒç‰¹å¾æ˜¯2-Dç‰¹å¾ã€‚é‡‡ç”¨çš„ä¾ç„¶æ˜¯ sincosæ¨¡å¼ï¼Œä½†æ˜¯éœ€è¦è€ƒè™‘ xyä¸¤ä¸ªæ–¹å‘ã€‚ä¸æ˜¯ç±»ä¼¼vitåšæ³•å°†å…¶æ‹‰ä¼¸ä¸ºä¸€ä¸ªå‘é‡ï¼Œç„¶åä»0-nè¿›è¡Œé•¿åº¦ä¸º256çš„ä½ç½®ç¼–ç ï¼Œè€Œæ˜¯è€ƒè™‘äº†xyæ–¹å‘åŒæ—¶ç¼–ç ï¼Œæ¯ä¸ªæ–¹å‘å„ç¼–ç 128ç»´å‘é‡ï¼Œè¿™ç§ç¼–ç æ–¹å¼æ›´ç¬¦åˆå›¾åƒç‰¹ç‚¹ã€‚</p>
<p>Positional Encodingçš„è¾“å‡ºå¼ é‡æ˜¯:(B,d,H,W)ï¼Œå…¶ä¸­ dä»£è¡¨ä½ç½®ç¼–ç çš„é•¿åº¦ï¼Œ H,Wä»£è¡¨å¼ é‡çš„ä½ç½®ã€‚ç‰¹å¾å›¾ä¸Šçš„ä»»æ„ä¸€ä¸ªç‚¹(H1,W1)æœ‰ä¸ªä½ç½®ç¼–ç ï¼Œè¿™ä¸ªç¼–ç çš„é•¿åº¦æ˜¯256ï¼Œå…¶ä¸­ï¼Œå‰128ç»´ä»£è¡¨ H1çš„ä½ç½®ç¼–ç ï¼Œå128ç»´ä»£è¡¨H2çš„ä½ç½®ç¼–ç ã€‚</p>
<p>è®¡ç®—ä»»æ„ä¸€ä¸ªä½ç½® (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ’‘</mi><mi>ğ’</mi><msub><mi>ğ’”</mi><mi>ğ’™</mi></msub></mrow><annotation encoding="application/x-tex">ğ’‘ğ’ğ’”_ğ’™</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord boldsymbol" style="margin-right:0.07861em;">p</span><span class="mord boldsymbol" style="margin-right:0.07861em;">o</span><span class="mord"><span class="mord boldsymbol" style="margin-right:0.08167em;">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:-0.08167em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.12583em;">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ’‘</mi><mi>ğ’</mi><msub><mi>ğ’”</mi><mi>ğ’š</mi></msub></mrow><annotation encoding="application/x-tex">ğ’‘ğ’ğ’”_ğ’š</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.730548em;vertical-align:-0.286108em;"></span><span class="mord boldsymbol" style="margin-right:0.07861em;">p</span><span class="mord boldsymbol" style="margin-right:0.07861em;">o</span><span class="mord"><span class="mord boldsymbol" style="margin-right:0.08167em;">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16110799999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.08167em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.105em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>) çš„Positional Encodingï¼ŒæŠŠ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ’‘</mi><mi>ğ’</mi><msub><mi>ğ’”</mi><mi>ğ’™</mi></msub></mrow><annotation encoding="application/x-tex">ğ’‘ğ’ğ’”_ğ’™</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord boldsymbol" style="margin-right:0.07861em;">p</span><span class="mord boldsymbol" style="margin-right:0.07861em;">o</span><span class="mord"><span class="mord boldsymbol" style="margin-right:0.08167em;">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:-0.08167em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.12583em;">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ä»£å…¥å³å¼çš„ aå¼å’Œ bå¼å¯ä»¥è®¡ç®—å¾—åˆ°128ç»´çš„å‘é‡ï¼Œå®ƒä»£è¡¨ xçš„ä½ç½®ç¼–ç ï¼Œå†æŠŠ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ’‘</mi><mi>ğ’</mi><msub><mi>ğ’”</mi><mi>ğ’š</mi></msub></mrow><annotation encoding="application/x-tex">ğ’‘ğ’ğ’”_ğ’š</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.730548em;vertical-align:-0.286108em;"></span><span class="mord boldsymbol" style="margin-right:0.07861em;">p</span><span class="mord boldsymbol" style="margin-right:0.07861em;">o</span><span class="mord"><span class="mord boldsymbol" style="margin-right:0.08167em;">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16110799999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.08167em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.105em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> ä»£å…¥å³å¼çš„ cå¼å’Œ då¼å¯ä»¥è®¡ç®—å¾—åˆ°128ç»´çš„å‘é‡ï¼Œå®ƒä»£è¡¨ yçš„ä½ç½®ç¼–ç ï¼ŒæŠŠè¿™2ä¸ª128ç»´çš„å‘é‡æ‹¼æ¥èµ·æ¥ï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ª256ç»´çš„å‘é‡ï¼Œå®ƒä»£è¡¨ (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ’‘</mi><mi>ğ’</mi><msub><mi>ğ’”</mi><mi>ğ’™</mi></msub></mrow><annotation encoding="application/x-tex">ğ’‘ğ’ğ’”_ğ’™</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord boldsymbol" style="margin-right:0.07861em;">p</span><span class="mord boldsymbol" style="margin-right:0.07861em;">o</span><span class="mord"><span class="mord boldsymbol" style="margin-right:0.08167em;">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.161108em;"><span style="top:-2.5500000000000003em;margin-left:-0.08167em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.12583em;">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ğ’‘</mi><mi>ğ’</mi><msub><mi>ğ’”</mi><mi>ğ’š</mi></msub></mrow><annotation encoding="application/x-tex">ğ’‘ğ’ğ’”_ğ’š</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.730548em;vertical-align:-0.286108em;"></span><span class="mord boldsymbol" style="margin-right:0.07861em;">p</span><span class="mord boldsymbol" style="margin-right:0.07861em;">o</span><span class="mord"><span class="mord boldsymbol" style="margin-right:0.08167em;">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16110799999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.08167em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.105em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>) çš„ä½ç½®ç¼–ç ã€‚</p>
<p>è®¡ç®—æ‰€æœ‰ä½ç½®çš„ç¼–ç ï¼Œå°±å¾—åˆ°äº†(256,H,W)çš„å¼ é‡ï¼Œä»£è¡¨è¿™ä¸ªbatchçš„ä½ç½®ç¼–ç ã€‚ç¼–ç çŸ©é˜µçš„ç»´åº¦æ˜¯ (B,256,H,W)ï¼Œä¹ŸæŠŠå®ƒåºåˆ—åŒ–æˆç»´åº¦ä¸º (HW,B,256)ç»´çš„å¼ é‡ï¼Œå‡†å¤‡ä¸(HW,B,256)ç»´çš„feature mapç›¸åŠ ä»¥åè¾“å…¥Encoderã€‚</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-49.png" class="">
<blockquote>
<p>ä¸åŸå§‹transformerç¼–ç å™¨ä¸åŒçš„åœ°æ–¹ï¼š</p>
<ul>
<li>è¾“å…¥ç¼–ç å™¨çš„ä½ç½®ç¼–ç éœ€è¦è€ƒè™‘2dç©ºé—´ä½ç½®</li>
<li>ä½ç½®ç¼–ç å‘é‡éœ€è¦åŠ å…¥åˆ°æ¯ä¸ªç¼–ç å™¨ä¸­</li>
<li>åœ¨ç¼–ç å™¨å†…éƒ¨ä½ç½®ç¼–ç ä»…ä»…å’ŒQKç›¸åŠ ï¼ŒVä¸åšä»»ä½•å¤„ç†</li>
</ul>
</blockquote>
<p><strong>ä»£ç å®ç°ï¼š</strong></p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-50.png" class="">
<img src="/article/Prospective-Graduate-Summer-Training-05/05-51.png" class="">
<h3 id="è§£ç å™¨è®¾è®¡å’Œè¾“å…¥"><a class="markdownIt-Anchor" href="#è§£ç å™¨è®¾è®¡å’Œè¾“å…¥"></a> è§£ç å™¨è®¾è®¡å’Œè¾“å…¥</h3>
<ul>
<li>Transformer Encoderè¾“å‡ºçš„Embeddingä¸ position encoding ä¹‹å’Œã€‚</li>
<li>Object queriesã€‚</li>
</ul>
<p>Object queriesæ˜¯ä¸€ä¸ªç»´åº¦ä¸º(100,b,256)ç»´çš„å¯å­¦ä¹ å¼ é‡ï¼Œå……å½“ä½ç½®ç¼–ç ä½œç”¨ã€‚</p>
<p>Object queriesçŸ©é˜µå†…éƒ¨é€šè¿‡å­¦ä¹ å»ºæ¨¡äº†100ä¸ªç‰©ä½“ä¹‹é—´çš„å…¨å±€å…³ç³»ï¼Œä¾‹å¦‚æˆ¿é—´é‡Œé¢çš„æ¡Œå­æ—è¾¹(Aç±»)ä¸€èˆ¬æ˜¯æ”¾æ¤…å­(Bç±»)ï¼Œè€Œä¸ä¼šæ˜¯æ”¾ä¸€å¤´å¤§è±¡(Cç±»)ï¼Œé‚£ä¹ˆåœ¨æ¨ç†æ—¶å€™å°±å¯ä»¥åˆ©ç”¨è¯¥å…¨å±€æ³¨æ„åŠ›æ›´å¥½çš„è¿›è¡Œè§£ç é¢„æµ‹è¾“å‡ºã€‚</p>
<p>Decoderçš„è¾“å…¥ä¸€å¼€å§‹ä¹Ÿåˆå§‹åŒ–æˆç»´åº¦ä¸º (100,b,256)ç»´çš„å…¨éƒ¨å…ƒç´ éƒ½ä¸º0çš„å¼ é‡ï¼Œå’ŒObject queriesåŠ åœ¨ä¸€èµ·ä¹‹åå……å½“ç¬¬1ä¸ªmulti-head self-attentionçš„Queryå’ŒKeyã€‚ç¬¬ä¸€ä¸ªmulti-head self-attentionçš„Valueä¸ºDecoderçš„è¾“å…¥ï¼Œä¹Ÿå°±æ˜¯å…¨0çš„å¼ é‡ã€‚</p>
<p><strong>å¯¹Encoderå’ŒDecoderçš„æ¯ä¸ªself-attentionçš„Queryå’ŒKeyçš„ä½ç½®ç¼–ç çš„å½’çº³</strong></p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-52.png" class="">
<p><strong>æ— åºé›†åˆè¾“å‡ºçš„lossè®¡ç®—ï¼š</strong></p>
<p>DETRè¾“å‡ºæ˜¯åŒ…æ‹¬(b,100)ä¸ªæ— åºé›†åˆï¼Œæ¯ä¸ªé›†åˆåŒ…æ‹¬ç±»åˆ«c[é•¿åº¦ä¸º92çš„åˆ†ç±»å‘é‡]å’Œåæ ‡ä¿¡æ¯(x,y,w,h)[é•¿åº¦ä¸º4çš„åæ ‡å‘é‡]ï¼Œæ•…DETRè¾“å‡ºé›†åˆåŒ…æ‹¬ä¸¤ä¸ªåˆ†æ”¯ï¼š</p>
<ul>
<li>åˆ†æ”¯shape=(b,100,92)ï¼Œbboxåæ ‡åˆ†æ”¯shape=(b,100,4)</li>
<li>å¯¹åº”çš„targetä¹Ÿæ˜¯åŒ…æ‹¬åˆ†ç±»targetå’Œbboxåæ ‡targetï¼Œå¦‚æœä¸å¤Ÿ100ï¼Œåˆ™é‡‡ç”¨èƒŒæ™¯å¡«å……ï¼Œè®¡ç®—lossæ—¶å€™bboxåˆ†æ”¯ä»…ä»…è®¡ç®—æœ‰ç‰©ä½“ä½ç½®ï¼ŒèƒŒæ™¯é›†åˆå¿½ç•¥ã€‚</li>
</ul>
<blockquote>
<p>åŒˆç‰™åˆ©ç®—æ³•ï¼š å¹¿æ³›åº”ç”¨äºæœ€ä¼˜åˆ†é…çš„äºŒåˆ†å›¾åŒ¹é…é—®é¢˜</p>
</blockquote>
<blockquote>
<p>çš„bx100ä¸ªæ£€æµ‹ç»“æœæ˜¯æ— åºçš„ï¼Œå¦‚ä½•å’Œgt bboxè®¡ç®—lossï¼Ÿ<br>
DETRä¸­åˆ©ç”¨åŒˆç‰™åˆ©ç®—æ³•å…ˆè¿›è¡Œæœ€ä¼˜ä¸€å¯¹ä¸€åŒ¹é…å¾—åˆ°åŒ¹é…ç´¢å¼•ï¼Œç„¶åå¯¹(b,100)ä¸ªç»“æœè¿›è¡Œé‡æ’å®ç°å’Œgt bboxå¯¹åº”ã€‚ä¼˜åŒ–çš„ç›®çš„æ˜¯æ‰¾åˆ°æœ€ä¼˜åŒ¹é…æ’åˆ—ï¼Œä½¿å¾—L_matchå’Œæœ€å°ã€‚</p>
</blockquote>
<p><strong>ä»£ç å®ç°ï¼š</strong></p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-53.png" class="">
<img src="/article/Prospective-Graduate-Summer-Training-05/05-54.png" class="">
<h3 id="åˆ†ç±»å’Œå›å½’head"><a class="markdownIt-Anchor" href="#åˆ†ç±»å’Œå›å½’head"></a> åˆ†ç±»å’Œå›å½’head</h3>
<p>åœ¨è§£ç å™¨è¾“å‡ºåŸºç¡€ä¸Šæ„å»ºåˆ†ç±»å’Œbboxå›å½’headå³å¯è¾“å‡ºæ£€æµ‹ç»“æœ</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-55.png" class="">
<blockquote>
<ul>
<li><strong>æ¨¡å‹å­¦ä¹ åˆ°äº†ä»€ä¹ˆï¼Ÿ</strong><br>
è®­ç»ƒå®Œä»¥åï¼ŒDETRæ¨¡å‹å­¦ä¹ åˆ°äº†ä¸€ç§èƒ½åŠ›ï¼Œå³ï¼šæ¨¡å‹äº§ç”Ÿçš„100ä¸ªé¢„æµ‹æ¡†ï¼Œå®ƒçŸ¥é“æŸä¸ªé¢„æµ‹æ¡†è¯¥å¯¹åº”ä»€ä¹ˆObjectï¼Œæ¯”å¦‚ï¼Œæ¨¡å‹å­¦ä¹ åˆ°ï¼šç¬¬1ä¸ªé¢„æµ‹æ¡†å¯¹åº” Car(label=3)ï¼Œç¬¬2ä¸ªé¢„æµ‹æ¡†å¯¹åº” Bus(label=16) ï¼Œç¬¬3ä¸ªé¢„æµ‹æ¡†å¯¹åº” Sky(label=21) ï¼Œç¬¬4-100ä¸ªé¢„æµ‹æ¡†å¯¹åº” âˆ…(label=92)ï¼Œç­‰ç­‰</li>
<li><strong>Object querieså­¦ä¹ åˆ°äº†ä»€ä¹ˆï¼Ÿ</strong><br>
å®ƒæ˜¯ä¸€ä¸ªç»´åº¦ä¸º(100,b,256)ç»´çš„å¼ é‡ï¼Œåˆå§‹æ—¶å…ƒç´ å…¨ä¸º 0ï¼Œæ˜¯å¯è®­ç»ƒçš„ã€‚è€ƒè™‘å•å¼ å›¾ç‰‡ï¼Œæ‰€ä»¥å‡è®¾Object queriesæ˜¯ä¸€ä¸ªç»´åº¦ä¸º (100,256)ç»´çš„å¼ é‡ã€‚è®­ç»ƒå®Œæ¨¡å‹ä»¥åï¼Œæ­¤æ—¶çš„Object queriesç©¶ç«Ÿä»£è¡¨ä»€ä¹ˆ?<br>
æŠŠObject queriesçœ‹æˆ100ä¸ªæ ¼å­ï¼Œæ¯ä¸ªæ ¼å­æ˜¯ä¸ª256ç»´çš„å‘é‡ã€‚è®­ç»ƒå®Œä»¥åï¼Œè¿™100ä¸ªæ ¼å­é‡Œé¢æ³¨å…¥äº†ä¸åŒObjectçš„ä½ç½®ä¿¡æ¯å’Œç±»åˆ«ä¿¡æ¯ã€‚æ¯”å¦‚ç¬¬1ä¸ªæ ¼å­é‡Œé¢çš„è¿™ä¸ª256ç»´çš„å‘é‡ä»£è¡¨ç€Carè¿™ç§Objectçš„ä½ç½®ä¿¡æ¯ï¼Œè¿™ç§ä¿¡æ¯æ˜¯é€šè¿‡è®­ç»ƒï¼Œè€ƒè™‘äº†æ‰€æœ‰å›¾ç‰‡çš„æŸä¸ªä½ç½®é™„è¿‘çš„Carç¼–ç ç‰¹å¾ï¼Œå±äºå’Œä½ç½®æœ‰å…³çš„å…¨å±€Carç»Ÿè®¡ä¿¡æ¯ã€‚æµ‹è¯•æ—¶ï¼Œå‡è®¾å›¾ç‰‡ä¸­æœ‰Car,Dog,Hourseä¸‰ç§ç‰©ä½“ï¼Œè¯¥å›¾ç‰‡ä¼šè¾“å…¥åˆ°ç¼–ç å™¨ä¸­è¿›è¡Œç‰¹å¾ç¼–ç ï¼Œå‡è®¾ç‰¹å¾æ²¡æœ‰ä¸¢å¤±ï¼ŒDecoderçš„Keyå’ŒValueå°±æ˜¯ç¼–ç å™¨è¾“å‡ºçš„ç¼–ç å‘é‡ï¼Œè€ŒQueryå°±æ˜¯Object queriesï¼Œå°±æ˜¯æˆ‘ä»¬çš„100ä¸ªæ ¼å­ã€‚<br>
Queryå¯ä»¥è§†ä½œä»£è¡¨ä¸åŒObjectçš„ä¿¡æ¯ï¼Œè€ŒKeyå’ŒValueå¯ä»¥è§†ä½œä»£è¡¨å›¾åƒçš„å…¨å±€ä¿¡æ¯ã€‚<br>
é€šè¿‡æ³¨æ„åŠ›æ¨¡å—å°†Queryå’ŒKeyè®¡ç®—ï¼Œç„¶ååŠ æƒValueå¾—åˆ°è§£ç å™¨è¾“å‡ºã€‚å¯¹äºç¬¬1ä¸ªæ ¼å­çš„Queryä¼šå’ŒKeyä¸­çš„æ‰€æœ‰å‘é‡è¿›è¡Œè®¡ç®—ï¼Œç›®çš„æ˜¯æŸ¥æ‰¾æŸä¸ªä½ç½®é™„è¿‘æœ‰æ²¡æœ‰Carï¼Œå¦‚æœæœ‰é‚£ä¹ˆè¯¥ç‰¹å¾å°±ä¼šåŠ æƒè¾“å‡ºï¼Œå¯¹äºç¬¬3ä¸ªæ ¼å­çš„Queryä¼šå’ŒKeyä¸­çš„æ‰€æœ‰å‘é‡è¿›è¡Œè®¡ç®—ï¼Œç›®çš„æ˜¯æŸ¥æ‰¾æŸä¸ªä½ç½®é™„è¿‘æœ‰æ²¡æœ‰Skyï¼Œå¾ˆé—æ†¾ï¼Œè¿™ä¸ªæ²¡æœ‰ï¼Œæ‰€ä»¥è¾“å‡ºçš„ä¿¡æ¯é‡Œé¢æ²¡æœ‰Skyã€‚<br>
æ•´ä¸ªè¿‡ç¨‹è®¡ç®—å®Œæˆåå°±å¯ä»¥æŠŠç¼–ç å‘é‡ä¸­çš„Car,Dog,Hourseçš„ç¼–ç åµŒå…¥ä¿¡æ¯æå–å‡ºæ¥ï¼Œç„¶ååé¢æ¥ FFNè¿›è¡Œåˆ†ç±»å’Œå›å½’å°±æ¯”è¾ƒå®¹æ˜“ï¼Œå› ä¸ºç‰¹å¾å·²ç»å¯¹é½äº†ã€‚</li>
</ul>
</blockquote>
<h3 id="æ•´ä½“æ¨ç†æµç¨‹"><a class="markdownIt-Anchor" href="#æ•´ä½“æ¨ç†æµç¨‹"></a> æ•´ä½“æ¨ç†æµç¨‹</h3>
<ul>
<li>å°†(b,3,800,1200)å›¾ç‰‡è¾“å…¥åˆ°resnet50ä¸­è¿›è¡Œç‰¹å¾æå–,è¾“å‡ºshape=(b,1024,25,38)</li>
<li>é€šè¿‡1x1å·ç§¯é™ç»´ï¼Œå˜æˆ(b,256,25,38)</li>
<li>åˆ©ç”¨sincoså‡½æ•°è®¡ç®—ä½ç½®ç¼–ç </li>
<li>å°†å›¾åƒç‰¹å¾å’Œä½ç½®ç¼–ç å‘é‡ç›¸åŠ ï¼Œä½œä¸ºç¼–ç å™¨è¾“å…¥ï¼Œè¾“å‡ºç¼–ç åçš„å‘é‡ï¼Œshapeä¸å˜</li>
<li>åˆå§‹åŒ–å…¨0çš„(100,b,256)çš„è¾“å‡ºåµŒå…¥å‘é‡ï¼Œç»“åˆä½ç½®ç¼–ç å‘é‡å’Œquery_embedï¼Œè¿›è¡Œè§£ç è¾“å‡ºï¼Œè§£ç å™¨è¾“å‡ºshapeä¸º(6,b,100,256)ï¼Œåé¢çš„è§£ç å™¨æ¥å—è¯¥è¾“å‡ºï¼Œç„¶åå†æ¬¡ç»“åˆç½®ç¼–ç å‘é‡å’Œquery_embedè¿›è¡Œè¾“å‡ºï¼Œä¸æ–­å‰å‘</li>
<li>å°†æœ€åä¸€ä¸ªè§£ç å™¨è¾“å‡ºè¾“å…¥åˆ°åˆ†ç±»å’Œå›å½’headä¸­ï¼Œå¾—åˆ°100ä¸ªæ— åºé›†åˆ</li>
<li>å¯¹100ä¸ªæ— åºé›†åˆè¿›è¡Œåå¤„ç†ï¼Œä¸»è¦æ˜¯æå–å‰æ™¯ç±»åˆ«å’Œå¯¹åº”çš„bboxåæ ‡ï¼Œä¹˜ä¸Š(800,1200)å³å¯å¾—åˆ°æœ€ç»ˆåæ ‡</li>
</ul>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-56.png" class="">
<h2 id="33-swin-transformer"><a class="markdownIt-Anchor" href="#33-swin-transformer"></a> 3.3 Swin Transformer</h2>
<p><strong>Transformer ä» NLP è¿ç§»åˆ° CV ä¸Šæ²¡æœ‰å¤§æ”¾å¼‚å½©ä¸»è¦æœ‰ä¸¤ç‚¹åŸå› ï¼š</strong></p>
<ul>
<li>æœ€ä¸»è¦çš„åŸå› æ˜¯ä¸¤ä¸ªé¢†åŸŸæ¶‰åŠçš„scaleä¸åŒï¼ŒNLP ä»»åŠ¡ä»¥ token ä¸ºå•ä½ï¼Œscale æ˜¯æ ‡å‡†å›ºå®šçš„ï¼Œè€Œ CV ä¸­åŸºæœ¬å…ƒç´ çš„ scale å˜åŒ–èŒƒå›´éå¸¸å¤§ã€‚</li>
<li>CV æ¯”èµ· NLP éœ€è¦æ›´å¤§çš„åˆ†è¾¨ç‡ï¼Œè€Œä¸” CV ä¸­ä½¿ç”¨ Transformer çš„è®¡ç®—å¤æ‚åº¦æ˜¯å›¾åƒå°ºåº¦çš„å¹³æ–¹ï¼Œè¿™ä¼šå¯¼è‡´è®¡ç®—é‡è¿‡äºåºå¤§ï¼Œ ä¾‹å¦‚è¯­ä¹‰åˆ†å‰²ï¼Œéœ€è¦åƒç´ çº§çš„å¯†é›†é¢„æµ‹ï¼Œè¿™å¯¹äºé«˜åˆ†è¾¨ç‡å›¾åƒä¸Šçš„Transformeræ¥è¯´æ˜¯éš¾ä»¥å¤„ç†çš„ã€‚</li>
</ul>
<p>Swin Transformer å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜æ‰€æå‡ºçš„ä¸€ç§é€šç”¨çš„è§†è§‰æ¶æ„ã€‚Swin Transformer å¼•å…¥ CNN ä¸­å¸¸ç”¨çš„<strong>å±‚æ¬¡åŒ–</strong>æ„å»ºæ–¹å¼ã€‚</p>
<h3 id="å›¾ç‰‡é¢„å¤„ç†åˆ†å—å’Œé™ç»´-patch-partition"><a class="markdownIt-Anchor" href="#å›¾ç‰‡é¢„å¤„ç†åˆ†å—å’Œé™ç»´-patch-partition"></a> å›¾ç‰‡é¢„å¤„ç†ï¼šåˆ†å—å’Œé™ç»´ (Patch Partition)</h3>
<p>Swin Transformer é¦–å…ˆæŠŠğ‘¯âˆ—ğ‘¾âˆ—ğ‘ªçš„å›¾ç‰‡ï¼Œå˜æˆä¸€ä¸ªğ‘µâˆ—(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>ğ’‘</mi><mi>ğŸ</mi></msup></mrow><annotation encoding="application/x-tex">ğ’‘^ğŸ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07861em;">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span></span></span></span></span></span></span></span>âˆ—ğ‘ª)çš„2ç»´çš„image patchesã€‚å®ƒå¯ä»¥çœ‹åšæ˜¯ä¸€ç³»åˆ—çš„å±•å¹³çš„2Då—çš„åºåˆ—ï¼Œè¿™ä¸ªåºåˆ—ä¸­ä¸€å…±æœ‰ğ‘¯âˆ—ğ‘¾/<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>ğ’‘</mi><mi>ğŸ</mi></msup></mrow><annotation encoding="application/x-tex">ğ’‘^ğŸ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07861em;">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span></span></span></span></span></span></span></span>ä¸ªå±•å¹³çš„2Då—ï¼Œæ¯ä¸ªå—çš„ç»´åº¦æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>ğ’‘</mi><mi>ğŸ</mi></msup></mrow><annotation encoding="application/x-tex">ğ’‘^ğŸ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07861em;">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span></span></span></span></span></span></span></span>âˆ—ğ‘ªã€‚å…¶ä¸­ ğ’‘æ˜¯å—å¤§å°ã€‚</p>
<p>åœ¨ Swin Transformer ä¸­ï¼Œå—çš„å¤§å°ğ’‘=ğŸ’ï¼Œæ‰€ä»¥å¾—åˆ°çš„å—çš„å¤§å°ğ‘µâˆ—ğŸ’ğŸ– ï¼Œè¿™é‡Œçš„ğ‘µ=<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>ğ‘¯</mi><mi mathvariant="normal">âˆ—</mi><mi>ğ‘¾</mi></mrow><mrow><mi>ğŸ</mi><mi>ğŸ”</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{ğ‘¯âˆ—ğ‘¾}{ğŸğŸ”}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.219277em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874277em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">1</span><span class="mord mathbf mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.17208em;">H</span><span class="mord mtight">âˆ—</span><span class="mord boldsymbol mtight" style="margin-right:0.18625em;">W</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>=<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>ğ‘¯</mi><mi>ğŸ’</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac ğ‘¯ğŸ’</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.219277em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874277em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.17208em;">H</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> âˆ— <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>ğ‘¾</mi><mi>ğŸ’</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac ğ‘¾ğŸ’</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.219277em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874277em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.18625em;">W</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ã€‚</p>
<p>æ‰€ä»¥ç»è¿‡äº†è¿™ä¸€æ­¥çš„åˆ†å—æ“ä½œï¼Œä¸€å¼  ğ‘¯âˆ—ğ‘¾âˆ—ğŸ‘çš„å›¾ç‰‡å°±å˜æˆäº† $ ğ‘¯ \over ğŸ’$ âˆ— $ \frac ğ‘¾ğŸ’$ âˆ— ğŸ’ğŸ–çš„å¼ é‡ï¼Œå¯ä»¥ç†è§£æˆæ˜¯ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>ğ‘¯</mi><mi>ğŸ’</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac ğ‘¯ğŸ’</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.219277em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874277em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.17208em;">H</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> âˆ— $ \frac ğ‘¾ğŸ’ $ä¸ªå›¾ç‰‡å—ï¼Œæ¯ä¸ªå—æ˜¯ä¸€ä¸ªğŸ’ğŸ–ç»´çš„ tokenã€‚</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-57.png" class="">
<h3 id="stage-1çº¿æ€§å˜æ¢-linear-embedding"><a class="markdownIt-Anchor" href="#stage-1çº¿æ€§å˜æ¢-linear-embedding"></a> Stage 1ï¼šçº¿æ€§å˜æ¢ (Linear Embedding)</h3>
<p>ç°åœ¨å¾—åˆ°çš„å‘é‡ç»´åº¦æ˜¯ï¼š$ \frac ğ‘¯ğŸ’$ âˆ— $ \frac ğ‘¾ğŸ’ $ âˆ— ğŸ’ğŸ– ï¼Œè¿˜éœ€è¦åšä¸€æ­¥å«åšLinear Embeddingçš„æ­¥éª¤ï¼Œå¯¹æ¯ä¸ªå‘é‡éƒ½åšä¸€ä¸ªçº¿æ€§å˜æ¢ï¼ˆå³å…¨è¿æ¥å±‚ï¼‰ï¼Œå˜æ¢åçš„ç»´åº¦ä¸º ğ‘ª ã€‚è¿™ä¸€æ­¥ä¹‹åå¾—åˆ°çš„å¼ é‡ç»´åº¦æ˜¯ï¼š$ \frac ğ‘¯ğŸ’ $ âˆ— $ \frac ğ‘¾ğŸ’ $ âˆ— ğ‘ª</p>
<h3 id="stage-1swin-transformer-block"><a class="markdownIt-Anchor" href="#stage-1swin-transformer-block"></a> Stage 1ï¼šSwin Transformer Block</h3>
<p>æ¥ä¸‹æ¥ $ \frac ğ‘¯ğŸ’ $ âˆ— $ \frac ğ‘¾ğŸ’ $ âˆ— ğ‘ª è¿™ä¸ªå¼ é‡è¿›å…¥2ä¸ªè¿ç»­çš„ Swin Transformer Block ä¸­ï¼Œè¿™è¢«ç§°ä½œ Stage 1ï¼Œåœ¨æ•´ä¸ªçš„ Stage 1 é‡Œé¢ token çš„æ•°é‡ä¸€ç›´ç»´æŒ $ \frac ğ‘¯ğŸ’$ âˆ— $ \frac ğ‘¾ğŸ’ $ ä¸å˜</p>
<p>ä¸€ä¸ª Swin Transformer Block ç”±ä¸€ä¸ªå¸¦ä¸¤å±‚ MLP çš„ Window-based MSA ç»„æˆï¼Œå¦ä¸€ä¸ª Swin Transformer Block ç”±ä¸€ä¸ªå¸¦ä¸¤å±‚ MLP çš„ Shifted Window-based MSA ç»„æˆ</p>
<h3 id="stage-1swin-transformer-blockwindow-based-msa"><a class="markdownIt-Anchor" href="#stage-1swin-transformer-blockwindow-based-msa"></a> Stage 1ï¼šSwin Transformer Blockï¼šWindow-based MSA</h3>
<p>æ ‡å‡† ViT çš„å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ MSA é‡‡ç”¨çš„æ˜¯å…¨å±€è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå³ï¼šè®¡ç®—æ¯ä¸ª token å’Œæ‰€æœ‰å…¶ä»– token çš„ attention mapã€‚å…¨å±€è‡ªæ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—å¤æ‚åº¦æ˜¯ O(ğ‘µ^ğŸâˆ—ğ’…) ï¼Œå…¶ä¸­ï¼Œ ğ‘µæ˜¯ tokençš„æ•°é‡ï¼Œ ğ’…æ˜¯ Embedding dimensionã€‚å…¨å±€è‡ªæ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—å¤æ‚åº¦ä¸åºåˆ—é•¿åº¦ğ‘µæˆå¹³æ–¹å…³ç³»ã€‚å½“å›¾ç‰‡åˆ†è¾¨ç‡è¾ƒé«˜æˆ–æ˜¯å¯†é›†é¢„æµ‹ä»»åŠ¡ä¸­è®¡ç®—é‡ä¼šè¿‡å¤§ã€‚</p>
<p>Window-based MSA ä¸åŒäºæ™®é€šçš„ MSAï¼Œå®ƒåœ¨ä¸€ä¸ªä¸ª window é‡Œé¢å»è®¡ç®— self-attentionã€‚å‡è®¾æ¯ä¸ª window é‡Œé¢åŒ…æ‹¬ğ‘´âˆ—ğ‘´ä¸ª image patchesï¼Œåˆ™ Window-based MSA å’Œæ™®é€šçš„ MSA çš„è®¡ç®—é‡åˆ†åˆ«ä¸ºï¼š</p>
<p class="katex-block katex-error" title="Error: Font metrics not found for font: .">ğ›€(ğ‘´ğ‘ºğ‘¨)=ğŸ’ğ’‰ğ’˜ğ‘ª^ğŸ+ğŸ(ğ’‰ğ’˜)^ğŸ ğ‘ª,
</p>
<p class="katex-block katex-error" title="Error: Font metrics not found for font: .">ğ›€(ğ‘¾âˆ’ğ‘´ğ‘ºğ‘¨)=ğŸ’ğ’‰ğ’˜ğ‘ª^ğŸ+ğŸğ‘´^ğŸ ğ’‰ğ’˜ğ‘ª
</p>
<p>ç”±äº Window çš„ patch æ•°é‡ ğ‘´è¿œå°äºå›¾ç‰‡patchæ•°é‡ ğ’‰ğ’˜ï¼ŒWindow-based MSA çš„è®¡ç®—é‡ä¸åºåˆ—é•¿åº¦ ğ=ğ’‰ğ’˜æˆçº¿æ€§å…³ç³»ã€‚</p>
<h3 id="stage-1swin-transformer-blockshifted-window-based-msa"><a class="markdownIt-Anchor" href="#stage-1swin-transformer-blockshifted-window-based-msa"></a> Stage 1ï¼šSwin Transformer Blockï¼šShifted Window-based MSA</h3>
<p>Window-based MSA è™½ç„¶å¤§å¹…èŠ‚çº¦äº†è®¡ç®—é‡ï¼Œä½†æ˜¯ç‰ºç‰²äº† windows ä¹‹é—´å…³ç³»çš„å»ºæ¨¡ï¼Œä¸é‡åˆçš„ Window ä¹‹é—´ç¼ºä¹ä¿¡æ¯äº¤æµå½±å“äº†æ¨¡å‹çš„è¡¨å¾èƒ½åŠ›ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œåœ¨ä¸¤ä¸ªè¿ç»­çš„Swin Transformer Blockä¸­äº¤æ›¿ä½¿ç”¨W-MSA å’Œ SW-MSAã€‚å°†å‰ä¸€å±‚ Swin Transformer Block çš„ 8x8 å°ºå¯¸feature mapåˆ’åˆ†æˆ 2x2 ä¸ªpatchï¼Œæ¯ä¸ª patch å°ºå¯¸ä¸º 4x4ï¼Œç„¶åå°†ä¸‹ä¸€å±‚ Swin Transformer Block çš„ Window ä½ç½®è¿›è¡Œç§»åŠ¨ï¼Œå¾—åˆ° 3x3 ä¸ªä¸é‡åˆçš„ patchã€‚ç§»åŠ¨ window çš„åˆ’åˆ†æ–¹å¼ä½¿ä¸Šä¸€å±‚ç›¸é‚»çš„ä¸é‡åˆ window ä¹‹é—´å¼•å…¥è¿æ¥ï¼Œå¤§å¤§çš„å¢åŠ äº†æ„Ÿå—é‡ã€‚</p>
<p>åœ¨æ–°çš„ window é‡Œé¢åš self-attention æ“ä½œï¼Œå°±å¯ä»¥åŒ…æ‹¬åŸæœ‰çš„ windows çš„è¾¹ç•Œï¼Œå®ç° windows ä¹‹é—´å…³ç³»çš„å»ºæ¨¡ã€‚</p>
<blockquote>
<p>å¼•å…¥ Shifted Window ä¼šå¸¦æ¥å¦ä¸€ä¸ªé—®é¢˜å°±æ˜¯ä¼šé€ æˆ window æ•°å‘ç”Ÿæ”¹å˜ï¼Œè€Œä¸”æœ‰çš„ window å¤§ï¼Œæœ‰çš„ window å°<br>
è§£æ”¾æ–¹æ¡ˆï¼šcycle shiftåˆå¹¶å°çš„ windows<br>
ç»è¿‡äº† cycle shift çš„æ–¹æ³•ï¼Œä¸€ä¸ª window å¯èƒ½ä¼šåŒ…æ‹¬æ¥è‡ªä¸åŒ window çš„å†…å®¹ã€‚æ¯”å³ä¸‹è§’çš„ windowï¼Œæ¥è‡ª4ä¸ªä¸åŒçš„ sub-windowã€‚å› æ­¤ï¼Œè¦é‡‡ç”¨ masked MSA æœºåˆ¶å°† self-attention çš„è®¡ç®—é™åˆ¶åœ¨æ¯ä¸ªå­çª—å£å†…ã€‚æœ€åé€šè¿‡ reverse cycle shift çš„æ–¹æ³•å°†æ¯ä¸ª window çš„ self-attention ç»“æœè¿”å›</p>
</blockquote>
<blockquote>
<p>cycle shiftè¿‡ç¨‹ï¼šæŒ‰ç…§ä¹‹å‰çš„ window åˆ’åˆ†ï¼Œå°±èƒ½å¤Ÿå¾—åˆ° window 5 çš„attention çš„ç»“æœäº†ã€‚ä½†æ˜¯è¿™æ ·æ“ä½œä¼šä½¿å¾— window 6 å’Œ 4 çš„ attention æ··åœ¨ä¸€èµ·ï¼Œwindow 1,3,7 å’Œ 9 çš„ attention æ··åœ¨ä¸€èµ·ã€‚æ‰€ä»¥éœ€è¦é‡‡ç”¨ masked MSA æœºåˆ¶å°† self-attention çš„è®¡ç®—é™åˆ¶åœ¨æ¯ä¸ªå­çª—å£å†…ï¼Œå¦‚ä½•å®ç°ï¼Ÿ<br>
æŒ‰ç…§ Swin Transformer çš„ä»£ç å®ç° ï¼Œè¿˜æ˜¯åšæ­£å¸¸çš„ self-attention (åœ¨ window_size ä¸Šåš)ï¼Œä¹‹åè¦è¿›è¡Œä¸€æ¬¡ mask æ“ä½œï¼ŒæŠŠä¸éœ€è¦çš„ attention å€¼ç»™å®ƒç½®ä¸º0</p>
</blockquote>
<h3 id="stage-234"><a class="markdownIt-Anchor" href="#stage-234"></a> Stage 2/3/4</h3>
<p>Stage 2 çš„è¾“å…¥æ˜¯ç»´åº¦æ˜¯ $ \frac ğ‘¯ğŸ’ $ âˆ— $ \frac ğ‘¾ğŸ’ $ âˆ— ğ‘ª çš„å¼ é‡ã€‚ä» Stage 2 åˆ° Stage 4 çš„æ¯ä¸ª stage çš„åˆå§‹é˜¶æ®µéƒ½ä¼šå…ˆåšä¸€æ­¥ Patch Merging æ“ä½œï¼ŒPatch Merging æ“ä½œçš„ç›®çš„æ˜¯ä¸ºäº†å‡å°‘ tokens çš„æ•°é‡ï¼Œå®ƒä¼šæŠŠç›¸é‚»çš„2Ã—2ä¸ª tokens ç»™åˆå¹¶åˆ°ä¸€èµ·ï¼Œå¾—åˆ°çš„ token çš„ç»´åº¦æ˜¯ ğŸ’ğ‘ª ã€‚Patch Merging æ“ä½œå†é€šè¿‡ä¸€æ¬¡çº¿æ€§å˜æ¢æŠŠç»´åº¦é™ä¸ºğŸğ‘ª ã€‚è‡³æ­¤ï¼Œç»´åº¦æ˜¯ $ \frac ğ‘¯ğŸ’ $ âˆ— $ \frac ğ‘¾ğŸ’ $ âˆ— ğ‘ª çš„å¼ é‡ç»è¿‡Patch Merging æ“ä½œå˜æˆäº†ç»´åº¦æ˜¯ $\frac ğ‘¯ğŸ– $ âˆ— $ \frac ğ‘¾ğŸ–$  âˆ— ğŸğ‘ª çš„å¼ é‡ã€‚</p>
<p>åŒç†ï¼ŒStage 3 çš„Patch Merging æ“ä½œä¼šæŠŠç»´åº¦æ˜¯ $\frac ğ‘¯ğŸ– $ âˆ— $ \frac ğ‘¾ğŸ–$  âˆ— ğŸğ‘ª çš„å¼ é‡å˜æˆç»´åº¦æ˜¯ $ \frac ğ‘¯{ğŸğŸ”} $ âˆ— $ \frac ğ‘¾{ğŸğŸ”} $ âˆ— ğŸ’ğ‘ª çš„å¼ é‡ã€‚Stage 4 çš„Patch Merging æ“ä½œä¼šæŠŠç»´åº¦æ˜¯  $ \frac ğ‘¯{ğŸğŸ”} $ âˆ— $ \frac ğ‘¾{ğŸğŸ”} $ âˆ— ğŸ’ğ‘ª çš„å¼ é‡å˜æˆç»´åº¦æ˜¯ $ \frac ğ‘¯{ğŸ‘ğŸ} âˆ— \frac ğ‘¾{ğŸ‘ğŸ} $ âˆ— ğŸ–ğ‘ª çš„å¼ é‡ã€‚</p>
<p>æ¯ä¸ª Stage éƒ½ä¼šæ”¹å˜å¼ é‡çš„ç»´åº¦ï¼Œå½¢æˆä¸€ç§å±‚æ¬¡åŒ–çš„è¡¨å¾ã€‚å› æ­¤ï¼Œè¿™ç§å±‚æ¬¡åŒ–çš„è¡¨å¾å¯ä»¥æ–¹ä¾¿åœ°æ›¿æ¢ä¸ºå„ç§è§†è§‰ä»»åŠ¡çš„éª¨å¹²ç½‘ç»œã€‚</p>
<h3 id="swin-transformer-çš„ä½ç½®ç¼–ç "><a class="markdownIt-Anchor" href="#swin-transformer-çš„ä½ç½®ç¼–ç "></a> Swin Transformer çš„ä½ç½®ç¼–ç </h3>
<p>Swin Transformer çš„ä½ç½®ç¼–ç åŠ åœ¨ attention çŸ©é˜µä¸Š</p>
<img src="/article/Prospective-Graduate-Summer-Training-05/05-58.png" class="">
<ul>
<li>ä½ç½®ç¼–ç ğ‘©çš„ç¬¬(ğ’Š,ğ’‹)ä¸ªå…ƒç´ ğ‘©(ğ’Š,ğ’‹) ï¼Œå®ƒä»£è¡¨çš„æ˜¯ Window é‡Œé¢ç¬¬ğ’Šä¸ª Patch å’Œç¬¬ğ’‹ä¸ª Patch çš„ç›¸å¯¹ä½ç½®å…³ç³»ã€‚</li>
<li>æ‰€ä»¥åº”è¯¥æœ‰ğ‘©(ğŸ‘,ğŸ•)=ğ‘©(ğŸ’,ğŸ–)=ğ‘©(ğŸ,ğŸ“)=ğ‘©(ğŸ,ğŸ’)ï¼Œå› ä¸ºå®ƒä»¬éƒ½ä»£è¡¨ç€æ–œå¯¹è§’çš„ä½ç½®å…³ç³»ã€‚</li>
<li>æ‰€ä»¥åº”è¯¥æœ‰ ğ‘©(ğŸ,ğŸ”)=ğ‘©(ğŸ,ğŸ•)=ğ‘©(ğŸ,ğŸ–)  ï¼Œå› ä¸ºå®ƒä»¬éƒ½ä»£è¡¨ç€ä¸Šä¸‹æœ‰é—´éš”çš„ä½ç½®å…³ç³»ã€‚</li>
<li>â€¦â€¦</li>
</ul>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>zhfly</span>
                    </p>
                
                
                
                
                     <p class="copyright-item">
                         <span>Tips:</span>
                         <span>If you have any questions, please contact me through the contact information on the home page, or contact me via email <strong>(33566183@qq.com)</strong>.</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/AI%EF%BC%88%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%EF%BC%89/"><i class="fa fa-tag"></i> AIï¼ˆäººå·¥æ™ºèƒ½ï¼‰</a>
                    
                        <a href="/tags/DL%EF%BC%88%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%EF%BC%89/"><i class="fa fa-tag"></i> DLï¼ˆæ·±åº¦å­¦ä¹ ï¼‰</a>
                    
                        <a href="/tags/Transformer/"><i class="fa fa-tag"></i> Transformer</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/article/Prospective-Graduate-Summer-Training-04.html">04. å·ç§¯ç¥ç»ç½‘ç»œåŸºç¡€å’Œç»å…¸æ¨¡å‹æ¦‚è§ˆ</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <!-- <span>Â© 2022 zhfly | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a> -->
        <span>Â© 2022 zhfly
        |
        <!-- è®¿å®¢æ•°é‡ -->
          
            <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span class="site-uv">
        UV:
        <i class="busuanzi-value" id="busuanzi_value_site_uv"><i class="fa fa-spinner fa-spin"></i></i>
    </span>&nbsp;



    <span class="site-pv">
        | PV:
        <i class="busuanzi-value" id="busuanzi_value_site_pv"><i class="fa fa-spinner fa-spin"></i></i>
    </span>
  
        
        </span>
    </div>
</footer>

    </div>

    <!-- æœç´¢åŠŸèƒ½ -->
    <!-- Chic/layout.ejs -->
    <div id="u-search">
        <div class="modal">
            <div class="modal-header">
                <div class="container">
                    <form id="u-search-modal-form" class="u-search-modal-form">
                        <button type="submit" class="form-submit-btn">
                            <img src="/image/search.png" class="search-btn-img" />
                        </button>
                        <input placeholder="æœç´¢å†…å®¹..." class="form-input" id="modal-form-input">
                    </form>
                    <a class="modal-close">x</a>
                </div>
                <div class="search-loading">
                    <div class="search-loading-bar"></div>
                </div>
            </div>
            <div class="modal-body">
            </div>
        </div>
        <div class="modal-overlay"></div>
    </div>

</body>

</html>